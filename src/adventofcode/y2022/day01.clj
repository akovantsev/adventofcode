(ns adventofcode.y2022.day01
  (:require [adventofcode.utils :as u]
            [clojure.string :as str]))

;https://adventofcode.com/2022/day/1

(def sample "1000\n2000\n3000\n\n4000\n\n5000\n6000\n\n7000\n8000\n9000\n\n10000")
(def data "6758\n5199\n10292\n8812\n3527\n10178\n1340\n2824\n\n62522\n\n22990\n\n6730\n\n7255\n3210\n3003\n8296\n8799\n7655\n10312\n\n18837\n19882\n5386\n15891\n\n4203\n36288\n\n1586\n2295\n4981\n2109\n2284\n5814\n4823\n5492\n1524\n5286\n2147\n2952\n4783\n4814\n3042\n\n8474\n4059\n14465\n13390\n\n4623\n2150\n7545\n7833\n3686\n2095\n3336\n5030\n7648\n4087\n4482\n\n31278\n29863\n\n1228\n4851\n2706\n1692\n3200\n3521\n5200\n3755\n3922\n5181\n5561\n5162\n5280\n2460\n\n1083\n4432\n4938\n4303\n6304\n3746\n3527\n3141\n3198\n4980\n4395\n\n8218\n3954\n1396\n2147\n7924\n4650\n4483\n6610\n4799\n3973\n\n3401\n4111\n7798\n5181\n8418\n5014\n5975\n7916\n7788\n1864\n\n8547\n13217\n9699\n5701\n11040\n2943\n\n6214\n3287\n4137\n6773\n2593\n4776\n1687\n2821\n7240\n3681\n1185\n6578\n\n7850\n6697\n4844\n2325\n1834\n6812\n3380\n2302\n2531\n4959\n\n5275\n1883\n6919\n2865\n7943\n7718\n9494\n7957\n\n28727\n22865\n\n3064\n4279\n2649\n12521\n\n10169\n16383\n3301\n12707\n\n3533\n2280\n9232\n10618\n1488\n7616\n4334\n7847\n\n4322\n1215\n3514\n5513\n3469\n5472\n3658\n1096\n3410\n1607\n5482\n3015\n5234\n2488\n\n1306\n8067\n3375\n4064\n2943\n6158\n3911\n7766\n2493\n4897\n6551\n\n10694\n13319\n\n10862\n2483\n8522\n4509\n5021\n8789\n6152\n\n7824\n23812\n6740\n\n6548\n2116\n14900\n\n3470\n1825\n2865\n4691\n4729\n4263\n4899\n4855\n3732\n4439\n5023\n1291\n3121\n5322\n\n6529\n\n5141\n2353\n8515\n9815\n9541\n10389\n1114\n1373\n\n11924\n11446\n20373\n\n37249\n\n5749\n2968\n5300\n5405\n7280\n6161\n4298\n7104\n7140\n3405\n5754\n\n4763\n11364\n7492\n5630\n15978\n\n3622\n2185\n12718\n2466\n5015\n11302\n\n65579\n\n5450\n6455\n\n5721\n1939\n8537\n7075\n1317\n1805\n1701\n4578\n8435\n1718\n\n10692\n6581\n3068\n9013\n1741\n4654\n2159\n5340\n\n4981\n6327\n6931\n3024\n1263\n4313\n6793\n2818\n6727\n2245\n4524\n5825\n\n10156\n11779\n1694\n7495\n1615\n8872\n11840\n\n7323\n7184\n4094\n3989\n1820\n2141\n7277\n3208\n2064\n7765\n5764\n\n2796\n3030\n2783\n3426\n5581\n1659\n2369\n2784\n5284\n4110\n1157\n3129\n6088\n2215\n3503\n\n20991\n1521\n\n1601\n4869\n9195\n1835\n5402\n2721\n1128\n1991\n9336\n\n2557\n6635\n6981\n6296\n5278\n3077\n7679\n5764\n2359\n2467\n6705\n\n2594\n2611\n3189\n1436\n1510\n1341\n8213\n8525\n5447\n2045\n\n3812\n2106\n6216\n3236\n7169\n5840\n4770\n1724\n1061\n5062\n7990\n\n5722\n4372\n3524\n1561\n3417\n5807\n3969\n3635\n3067\n3469\n4393\n1705\n4897\n4307\n2663\n\n28920\n3093\n\n12949\n9070\n9161\n3530\n6651\n\n12010\n1783\n21165\n\n4667\n3553\n6938\n5433\n3244\n1082\n7305\n7262\n6577\n1987\n2256\n\n4933\n1802\n1315\n1303\n1722\n2688\n6103\n2749\n1478\n4994\n4369\n5074\n5655\n2827\n3232\n\n1101\n2284\n4349\n4868\n3264\n3227\n1786\n5233\n6054\n6144\n3533\n1841\n1721\n4775\n\n16514\n\n7282\n7260\n2423\n1738\n4498\n5570\n3862\n3979\n3845\n4313\n3249\n5639\n\n7910\n9862\n7476\n9103\n2851\n3634\n8641\n7369\n\n8574\n1439\n1442\n12337\n1387\n7777\n\n18060\n\n10287\n1924\n4066\n12275\n14094\n\n4797\n5061\n2701\n1391\n6617\n5870\n4999\n4150\n2881\n2667\n2461\n1978\n1058\n\n12911\n7290\n9442\n2875\n5812\n\n13016\n4985\n2517\n9758\n11215\n\n2845\n11805\n6418\n8128\n1604\n\n9643\n6574\n6804\n3575\n9226\n6276\n1406\n4493\n8104\n\n11616\n7196\n5685\n1267\n3281\n1250\n7666\n\n9654\n8646\n7144\n2790\n7583\n2681\n1799\n5301\n1714\n\n30086\n23066\n\n10205\n7316\n1550\n4056\n2627\n10056\n\n9912\n1615\n1584\n2963\n1347\n9336\n8310\n8728\n\n2436\n4741\n6665\n5239\n5737\n4252\n1954\n4916\n5341\n7475\n5909\n5012\n\n4897\n8580\n5122\n1865\n8318\n5369\n2334\n5629\n7058\n\n14621\n2969\n15900\n14828\n2997\n\n7051\n3305\n7848\n7947\n3961\n3206\n5175\n7055\n3182\n5838\n1954\n\n6614\n3086\n7740\n6624\n4106\n7195\n\n3815\n4858\n3460\n1427\n5685\n5865\n4790\n6660\n1510\n5685\n2790\n5112\n\n13626\n1665\n16722\n9598\n\n15870\n\n3453\n8531\n9997\n8590\n5833\n7896\n8524\n\n6783\n5931\n3245\n4327\n5496\n5017\n2136\n3899\n3875\n2904\n5023\n3173\n3227\n\n4241\n4693\n1164\n1877\n5541\n5017\n3433\n3333\n4734\n3639\n1724\n2439\n1673\n4362\n\n6479\n3259\n3496\n6125\n1147\n3181\n3948\n5746\n3019\n1924\n\n6250\n26443\n\n4901\n6813\n6581\n3144\n1525\n6629\n3254\n6542\n1156\n6663\n3856\n4083\n1598\n\n7932\n8717\n9657\n1873\n2727\n2052\n2376\n\n6455\n13127\n3540\n8038\n6601\n2249\n\n6226\n5251\n3416\n5941\n7336\n5668\n4139\n1459\n2529\n7538\n\n6899\n4680\n10277\n2515\n16361\n\n23283\n2647\n\n1272\n3462\n6817\n3795\n4973\n6750\n2340\n7379\n3873\n1832\n7935\n\n4808\n4018\n11801\n7092\n8312\n9718\n6693\n\n7285\n7822\n7063\n2854\n7844\n1121\n4362\n4685\n5360\n7140\n6796\n\n17114\n20195\n9330\n\n19378\n27739\n\n16288\n15298\n13251\n5444\n10856\n\n7616\n6108\n3420\n9201\n3422\n4312\n4388\n3008\n9551\n\n1255\n7803\n1598\n3892\n6954\n7936\n8078\n5261\n2057\n2914\n\n7497\n10296\n2343\n10020\n1171\n3092\n2333\n\n1492\n4718\n4267\n10309\n7919\n7080\n1012\n9981\n\n17367\n1357\n16269\n7775\n\n13641\n3004\n13280\n\n6205\n3003\n1634\n4608\n2759\n6324\n4372\n4833\n6565\n2865\n7345\n3719\n\n4268\n2071\n2155\n4408\n4869\n2634\n1329\n2075\n4276\n4032\n2129\n5181\n2594\n2102\n2281\n\n2486\n7483\n6748\n4017\n5926\n3507\n4666\n3837\n\n8082\n13626\n12247\n5622\n13565\n\n7911\n1180\n1854\n5795\n7017\n6873\n7728\n5055\n5207\n7810\n7474\n\n3459\n5418\n1420\n5028\n6793\n4851\n2885\n2263\n2734\n4868\n6596\n1434\n5440\n\n3368\n3541\n5756\n3039\n4234\n2632\n6031\n5613\n4769\n1538\n4898\n5128\n4848\n\n2817\n3013\n2260\n4714\n6461\n3262\n3924\n4083\n2487\n4221\n5311\n4274\n5591\n1625\n\n8756\n8549\n9481\n7994\n7775\n6951\n5276\n7598\n9126\n\n11749\n7152\n14494\n\n14395\n7799\n16109\n14178\n\n24404\n4941\n\n5326\n9070\n3951\n1404\n6513\n9155\n5981\n3880\n1476\n\n12661\n10966\n\n3517\n7760\n4724\n6891\n1447\n3337\n3903\n7382\n7067\n1771\n1184\n\n3556\n13458\n12699\n12330\n13534\n11244\n\n10818\n31380\n\n17968\n3978\n17994\n\n9486\n6163\n1748\n3765\n7191\n1461\n2062\n8169\n9167\n\n3111\n4378\n3560\n6292\n5521\n2132\n5071\n4519\n1977\n6587\n\n11961\n2119\n11633\n10970\n4089\n7390\n6481\n\n4350\n5261\n4801\n1584\n1531\n5034\n5917\n4136\n6668\n5364\n3814\n3873\n4437\n\n2568\n2449\n5582\n1857\n6143\n5457\n4396\n3723\n2885\n2428\n2790\n4173\n1726\n5687\n\n21758\n\n32901\n\n4313\n12688\n14465\n1073\n6568\n\n2295\n3872\n5979\n3014\n1408\n1865\n2937\n4231\n5076\n2544\n3270\n2673\n6060\n4292\n1073\n\n5340\n10378\n10445\n11874\n8275\n8558\n1558\n\n3652\n9630\n15612\n18471\n\n5856\n4627\n4762\n6094\n5266\n2970\n1230\n6292\n5083\n4557\n6158\n5841\n6321\n3672\n\n4531\n2204\n4583\n4426\n4310\n6136\n5577\n4765\n6882\n1300\n2979\n6754\n4241\n\n3266\n6610\n2322\n12666\n11874\n10495\n\n7493\n2468\n2710\n6550\n7383\n4442\n3692\n8168\n\n4381\n3648\n4270\n3016\n4178\n3066\n1736\n5402\n4995\n1980\n5438\n5256\n4804\n4854\n2585\n\n4096\n4397\n4061\n3811\n2537\n3296\n1877\n4267\n2760\n3682\n5949\n3713\n3365\n4135\n1310\n\n30319\n\n7244\n6071\n1234\n6387\n1980\n1935\n3431\n6474\n6601\n1652\n\n10125\n11599\n\n4436\n3242\n6077\n6707\n1582\n6648\n3345\n5812\n1635\n2782\n2514\n2608\n\n9244\n1348\n5019\n2059\n9226\n2546\n5130\n8902\n7779\n\n10030\n10749\n3690\n8769\n9835\n7216\n2132\n\n6105\n1205\n1860\n3190\n5815\n1424\n2611\n1230\n4491\n1731\n5804\n2863\n1816\n3694\n\n4791\n6491\n3292\n3310\n2223\n4296\n6323\n3414\n1462\n6799\n3276\n4435\n5554\n\n2859\n2854\n1127\n4179\n6233\n6219\n5955\n3139\n2457\n3854\n5071\n4887\n4190\n4469\n\n67818\n\n7880\n6503\n4931\n5813\n1692\n2126\n6300\n8743\n4983\n2182\n\n1882\n5752\n6369\n1996\n2955\n5978\n6087\n5123\n2587\n2000\n4973\n2214\n5118\n3178\n\n10807\n9780\n8468\n2157\n1021\n8078\n4848\n\n3400\n1666\n6908\n10199\n1685\n4979\n\n2250\n5672\n2505\n9061\n5514\n8895\n4958\n8274\n7707\n\n15083\n2359\n23052\n\n6279\n1563\n4247\n4593\n4844\n5335\n7024\n7324\n5904\n1016\n3394\n3382\n\n2965\n2673\n3329\n1833\n1222\n1789\n1027\n6268\n4404\n1031\n1407\n4510\n4047\n1972\n\n4423\n8018\n4991\n7190\n7061\n6223\n5972\n2864\n5674\n\n1559\n1850\n4117\n1495\n2604\n2243\n1498\n4936\n2970\n4109\n1252\n6416\n5293\n3319\n\n5577\n4032\n3528\n6140\n5994\n2811\n3247\n7297\n5776\n3863\n4240\n3973\n\n9884\n8267\n\n3047\n4053\n2400\n4246\n3193\n2309\n4014\n1369\n1437\n\n10529\n2975\n3033\n10601\n13985\n\n12323\n9086\n2903\n7243\n8351\n12729\n\n13982\n7013\n7500\n11098\n9206\n\n11963\n3055\n9862\n2601\n13991\n\n66684\n\n6171\n1924\n1569\n3761\n4616\n5565\n3644\n1817\n4029\n2333\n1934\n2492\n6161\n\n2802\n1498\n3232\n7475\n5503\n4913\n6759\n8657\n4445\n\n18324\n19871\n\n6287\n4271\n7871\n1097\n1932\n5980\n5376\n7824\n4911\n4751\n6453\n\n8374\n3293\n7175\n8288\n1217\n4831\n1514\n6681\n2596\n6199\n\n32039\n\n1235\n2206\n6429\n4880\n5463\n6814\n1530\n3544\n4685\n3169\n6752\n5854\n6764\n\n6115\n6039\n6519\n6414\n4558\n5214\n4411\n2882\n6006\n5117\n5321\n2059\n\n2431\n5892\n1839\n5352\n3295\n2768\n4788\n5271\n1503\n1173\n4691\n4906\n4346\n1043\n\n5172\n5976\n6248\n4288\n3851\n8543\n4189\n4396\n\n10361\n14864\n18037\n\n7381\n5180\n1829\n3624\n3144\n3962\n5923\n4356\n1477\n3153\n2891\n5196\n\n3143\n3180\n4428\n3418\n6243\n3480\n1151\n4262\n4958\n4641\n3823\n1469\n2149\n\n3702\n4159\n3799\n4639\n5703\n2425\n4579\n2397\n2814\n3959\n3987\n3088\n2982\n2338\n3432\n\n7256\n16171\n12417\n11290\n13105\n\n2594\n5105\n6253\n4743\n4251\n6439\n3370\n5662\n2763\n3147\n6366\n4537\n6279\n6104\n\n7926\n3430\n2206\n4334\n5226\n1817\n2404\n2587\n8020\n1849\n\n1257\n6091\n2485\n6366\n3184\n4775\n5987\n3473\n5761\n1905\n3742\n5478\n5343\n\n3336\n5819\n2617\n2756\n5602\n3921\n4660\n5041\n1471\n2297\n5575\n1473\n6059\n3111\n5789\n\n2647\n6183\n5004\n2750\n2772\n1964\n4453\n2132\n3181\n2916\n1804\n4666\n1215\n6354\n\n1449\n1539\n3005\n3167\n1712\n6222\n6007\n4141\n1481\n6198\n4476\n3850\n3885\n5880\n\n1833\n5557\n3185\n6117\n3456\n2789\n4576\n1439\n3212\n5223\n2687\n2368\n3270\n4629\n4716\n\n10123\n6686\n12658\n\n6838\n4415\n10796\n6040\n3065\n1832\n11624\n\n69368\n\n5469\n8816\n7624\n13506\n\n8923\n1621\n10042\n\n6113\n9373\n9212\n7054\n3193\n6588\n7743\n4224\n4983\n\n1911\n1589\n2667\n3095\n3768\n5898\n4574\n3456\n3281\n4176\n1591\n3383\n5063\n\n1378\n5923\n9019\n4379\n2932\n3918\n9631\n\n7851\n6466\n2388\n13209\n7613\n2396\n\n3015\n1119\n4172\n2459\n3872\n5912\n4012\n2894\n2765\n1950\n4147\n4523\n2504\n4691\n2038\n\n4472\n5029\n3599\n6237\n8566\n3508\n7995\n3756\n6631\n3625\n\n16549\n15550\n22868\n\n7356\n11800\n8330\n14503\n9470\n\n1306\n1960\n6574\n7234\n3841\n1006\n4156\n2019\n6187\n2494\n7475\n5916\n\n8894\n9358\n9666\n8711\n10140\n11205\n\n8123\n19317\n11676\n7989\n\n7610\n3163\n9789\n6331\n6998\n7288\n4632\n5340\n\n7105\n15276\n22300\n\n11919\n6212\n5062\n\n18496\n10383\n10695\n4206\n\n8127\n2277\n10392\n1337\n2779\n5380\n3881\n6556\n\n5514\n6678\n2324\n4686\n3807\n4785\n3972\n\n1488\n3662\n4866\n2687\n3519\n2605\n5189\n5313\n4112\n2559\n1887\n5656\n5931\n1816\n\n9949\n11409\n8427\n15008\n2241\n\n1942\n1004\n1070\n5860\n4932\n4055\n2922\n5129\n1232\n4940\n5270\n1023\n5323\n2002\n2727\n\n48445\n\n6687\n4155\n2999\n3348\n\n5347\n4592\n1463\n3080\n3520\n5283\n3166\n2945\n2891\n1100\n5372\n5797\n3060\n5748\n5592\n\n8132\n3941\n7625\n4458\n2714\n7390\n4305\n1612\n6707\n\n2105\n2880\n6683\n6257\n6472\n1371\n3493\n1542\n4431\n5003\n3276\n2205\n3417\n\n6421\n4279\n1213\n6274\n3757\n6856\n3244\n1554\n2716\n1854\n1924\n3769\n6344\n\n1081\n2601\n2607\n6042\n1967\n2924\n4656\n6462\n1747\n4278\n6384\n4427\n5074\n6454\n\n6344\n13912\n15708\n1335\n5433\n\n5862\n7799\n3707\n9404\n10527\n10543\n6428\n\n2009\n17261\n13328\n\n10389\n9214\n9189\n8747\n12720\n9443\n\n7162\n2362\n3837\n8891\n2098\n8577\n9063\n3336\n5023\n\n1322\n12214\n5387\n9804\n9542\n6149\n\n1997\n6709\n6614\n5116\n6691\n5904\n5563\n2437\n4442\n7346\n5749\n7194\n\n5836\n15439\n9020\n9124\n\n6761\n4892\n5956\n2500\n6879\n1980\n1908\n1705\n6157\n4559\n5776\n1235\n3077\n\n10155\n8529\n7837\n7027\n7897\n6504\n4192\n7193\n\n9711\n17664\n4069\n10400\n\n24373\n20215\n\n2155\n9371\n9201\n5590\n9806\n13380\n\n7716\n1116\n6106\n2703\n2403\n3549\n3740\n6658\n4769\n\n13954\n36130\n\n1767\n7955\n5622\n5077\n2512\n8206\n4501\n2917\n9336\n\n1601\n23493\n16981\n\n3719\n2266\n1982\n4557\n3198\n3815\n5006\n2587\n4173\n2965\n2658\n4890\n5723\n4231\n\n19350\n\n19637\n13784\n21672\n\n17040\n29745\n\n2037\n7872\n5766\n7919\n1382\n9398\n3197\n\n11570\n12560\n6206\n12642\n3275\n\n1535\n6685\n5587\n12955\n12197\n\n2980\n15784\n12178\n12996\n\n7928\n8780\n7528\n5428\n8181\n8527\n5229\n3850\n2012\n2975\n\n30992\n26372\n\n4384\n2425\n2332\n1309\n3899\n3062\n4825\n1428\n1116\n3635\n1669\n1922\n5941\n4378\n2742\n\n1961\n4243\n4443\n3070\n5786\n3638\n6330\n2461\n1612\n4572\n3551\n3831\n3263\n6173\n\n2759\n3889\n5197\n4293\n2957\n6305\n3797\n1465\n4674\n5659\n5258\n3775\n4436\n2260\n\n5141\n8383\n6249\n9982\n4848\n2675\n4232\n8974\n\n11489\n11733\n9990\n4150\n4533\n3032\n1044\n\n62338\n\n3645\n5406\n4672\n3889\n5799\n5760\n4356\n5557\n4120\n2771\n3399\n5292\n3640\n3989\n6047\n\n4629\n6897\n4312\n2108\n5301\n1122\n1893\n5508\n3414\n2180\n4254")

(defn counts [input]
  (->> input str/split-lines
    (partition-by empty?)
    (remove #(-> % first empty?))
    (map #(->> % (map u/to-int) (reduce + 0)))))

(defn p1 [input] (->> input counts (reduce max)))
(defn p2 [input] (->> input counts (sort >) (take 3) (reduce + 0)))

(assert (= (p1 sample) 24000))
(assert (= (p1 data) 71506))
(assert (= (p2 sample) 45000))
(assert (= (p2 data) 209603))
