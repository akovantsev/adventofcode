(ns adventofcode.y2022.day04
  (:require [clojure.string :as str]
            [adventofcode.utils :as u]))


(def sample "2-4,6-8\n2-3,4-5\n5-7,7-9\n2-8,3-7\n6-6,4-6\n2-6,4-8")
(def input "51-88,52-87\n41-55,22-56\n6-74,74-86\n51-98,52-86\n8-77,3-94\n76-76,77-97\n29-42,29-35\n59-97,60-60\n9-86,27-86\n58-85,59-85\n23-41,26-39\n87-91,74-93\n13-83,83-84\n16-82,15-82\n15-95,14-96\n1-1,2-93\n3-87,2-74\n6-47,7-78\n47-68,47-92\n4-64,5-68\n14-14,8-45\n38-52,52-53\n8-19,25-85\n34-80,35-81\n64-64,64-80\n28-54,53-64\n10-97,16-98\n9-94,93-95\n15-67,16-67\n7-83,8-83\n6-95,90-99\n2-4,3-52\n21-50,20-50\n47-49,15-47\n4-38,7-38\n5-72,13-59\n7-82,2-7\n3-85,4-91\n11-79,6-9\n87-94,77-88\n10-10,8-12\n44-59,58-60\n94-97,5-90\n30-73,29-30\n1-87,10-78\n16-53,6-9\n26-88,27-53\n21-68,67-69\n49-62,50-61\n20-32,10-34\n28-29,21-31\n47-55,89-98\n84-85,23-85\n10-54,11-54\n52-92,19-51\n66-85,48-98\n43-44,44-85\n44-97,43-58\n24-76,68-70\n35-52,13-53\n46-62,43-80\n2-99,21-58\n29-73,28-29\n56-71,56-71\n16-80,14-81\n22-64,16-63\n42-59,42-74\n39-79,39-79\n21-98,20-98\n48-49,49-97\n9-88,10-88\n72-73,51-72\n7-81,6-82\n68-70,15-69\n98-99,70-75\n82-82,16-82\n38-42,38-80\n96-99,1-95\n46-92,45-45\n38-44,37-45\n94-97,93-96\n7-59,43-58\n2-86,85-87\n17-26,22-26\n6-68,5-10\n8-91,91-99\n7-93,13-93\n61-92,61-81\n40-67,30-68\n25-53,38-50\n2-64,3-98\n58-70,58-68\n57-89,57-89\n32-69,31-76\n14-90,4-90\n58-82,32-86\n47-70,46-69\n5-82,3-5\n7-47,42-43\n98-98,1-99\n60-84,60-83\n10-38,9-91\n12-98,10-99\n57-74,56-56\n11-96,10-11\n25-92,24-24\n61-82,99-99\n52-67,54-56\n2-81,1-81\n48-49,1-47\n22-68,36-69\n2-90,7-89\n24-57,31-56\n1-65,46-63\n1-87,39-86\n78-82,80-99\n66-68,35-74\n13-92,14-93\n32-80,32-40\n98-98,4-99\n98-98,2-7\n28-28,28-81\n27-53,15-54\n3-84,1-1\n3-34,9-31\n40-97,19-96\n13-60,7-60\n24-76,40-75\n91-92,5-91\n40-42,8-41\n73-75,28-74\n95-95,44-96\n13-16,16-74\n22-71,21-71\n7-7,5-15\n1-80,4-81\n36-71,37-72\n84-85,68-85\n16-63,12-12\n11-50,4-49\n30-94,10-95\n2-73,2-98\n10-85,10-85\n49-58,30-59\n48-67,15-32\n31-69,32-68\n71-94,70-98\n10-93,9-93\n5-5,6-95\n71-89,70-71\n41-66,6-42\n7-90,6-90\n78-79,17-78\n83-84,2-84\n2-99,1-99\n65-86,66-82\n44-49,44-46\n58-90,90-91\n7-38,8-97\n14-74,88-99\n54-91,53-88\n34-56,34-76\n13-55,14-55\n64-64,63-76\n24-89,4-92\n69-83,68-70\n11-92,10-95\n41-63,35-63\n42-65,43-64\n26-64,64-78\n25-47,16-20\n14-54,13-55\n77-77,76-93\n15-15,16-85\n67-71,66-70\n9-17,12-18\n12-95,12-95\n70-76,29-70\n6-13,7-12\n9-77,8-12\n57-94,7-57\n86-87,87-90\n45-89,63-98\n45-55,63-93\n81-82,7-81\n7-77,76-78\n19-58,9-19\n1-93,2-92\n57-83,56-58\n2-98,4-98\n1-18,1-9\n39-74,27-44\n5-73,3-95\n36-62,94-95\n62-73,61-81\n33-63,53-62\n34-45,33-33\n13-25,12-12\n91-92,25-91\n19-23,41-85\n4-10,24-92\n29-35,35-80\n19-23,22-76\n4-70,5-52\n4-90,3-89\n49-84,19-85\n7-65,6-6\n37-81,31-37\n18-77,76-76\n20-88,87-89\n16-91,79-90\n82-84,39-83\n3-23,39-47\n26-94,95-99\n8-98,7-9\n4-54,21-27\n5-78,20-79\n21-52,22-35\n4-53,2-77\n26-71,18-71\n11-71,12-12\n10-77,9-9\n88-97,41-87\n60-97,96-98\n2-7,8-60\n59-63,60-63\n81-82,31-81\n92-92,86-93\n75-82,16-75\n32-76,33-33\n69-93,70-93\n25-59,24-57\n56-57,41-69\n56-94,55-74\n6-94,28-58\n44-93,45-92\n44-44,44-92\n33-45,46-56\n4-55,11-54\n11-98,12-99\n35-61,37-61\n2-3,8-99\n2-2,4-29\n29-49,21-49\n4-17,19-85\n47-75,47-92\n11-12,11-98\n84-85,21-84\n55-99,54-96\n24-28,4-32\n22-88,21-23\n12-93,11-92\n13-80,13-79\n89-91,3-90\n16-72,57-59\n16-82,82-82\n26-39,13-19\n72-78,73-77\n18-87,96-98\n73-90,60-73\n44-44,3-95\n5-94,4-95\n28-68,29-49\n13-72,14-73\n10-99,5-98\n25-38,11-48\n30-98,97-99\n12-91,13-92\n1-85,2-20\n6-6,8-98\n16-86,86-94\n6-99,3-99\n77-81,3-76\n1-30,9-14\n43-74,42-43\n33-93,32-92\n3-68,4-69\n2-96,2-21\n65-81,80-88\n19-19,20-93\n14-41,32-34\n34-80,34-82\n3-81,9-82\n72-96,72-99\n16-43,42-60\n8-88,54-60\n92-94,93-95\n80-95,80-95\n81-82,29-81\n12-85,13-43\n5-93,91-92\n34-78,51-65\n10-75,9-75\n61-65,33-77\n18-18,19-97\n69-80,70-81\n90-92,68-91\n4-29,5-30\n71-80,70-83\n4-85,5-84\n99-99,26-87\n8-35,35-97\n64-66,30-65\n24-85,21-86\n4-9,10-92\n4-29,3-5\n11-72,11-72\n76-78,62-80\n38-80,48-79\n30-86,2-90\n14-98,15-87\n11-39,7-39\n6-99,7-7\n45-87,13-18\n13-84,12-12\n79-80,79-94\n22-81,23-29\n6-7,7-54\n8-75,9-19\n62-89,62-76\n54-99,53-99\n21-74,5-75\n44-44,46-81\n34-92,34-92\n94-94,11-95\n4-95,13-94\n65-68,67-97\n13-52,12-13\n3-17,17-18\n24-94,67-95\n57-74,56-56\n31-58,18-41\n71-78,70-71\n80-90,80-89\n64-75,4-65\n19-70,46-69\n2-5,4-79\n52-95,73-96\n28-57,15-90\n21-59,53-58\n10-27,6-10\n21-98,58-97\n81-93,82-93\n81-84,50-82\n19-29,20-25\n95-97,1-96\n3-65,38-39\n24-98,25-97\n42-69,15-43\n50-51,37-50\n17-97,16-84\n26-58,41-57\n25-66,24-24\n21-61,57-69\n7-83,6-84\n43-76,51-75\n26-30,32-87\n55-55,56-56\n41-58,57-87\n49-82,48-83\n25-46,45-45\n7-88,1-94\n8-89,7-8\n9-18,11-12\n19-94,94-97\n2-98,1-1\n40-60,41-85\n13-14,13-99\n30-34,29-33\n22-22,21-21\n27-28,25-27\n5-23,16-22\n37-54,54-72\n16-21,25-42\n33-70,47-70\n57-65,57-64\n78-78,15-79\n44-49,44-98\n27-56,20-33\n81-85,71-95\n91-92,1-92\n52-76,50-51\n21-94,21-94\n20-94,21-28\n57-60,59-98\n21-42,22-62\n48-48,42-52\n27-86,21-94\n63-96,63-96\n1-71,1-71\n5-48,47-80\n90-91,28-90\n13-67,13-65\n97-97,13-98\n6-20,7-55\n1-65,2-65\n83-98,98-99\n11-46,45-69\n6-68,6-55\n52-73,53-74\n77-82,77-80\n89-98,6-98\n63-65,17-64\n8-26,1-8\n11-79,3-12\n7-95,2-99\n92-99,50-93\n14-84,83-83\n1-99,1-99\n47-76,46-77\n3-55,2-56\n43-79,79-94\n14-64,43-65\n58-63,59-62\n5-99,2-5\n64-66,6-65\n17-91,16-90\n82-92,91-93\n15-77,16-47\n27-98,59-91\n18-93,17-90\n11-26,17-82\n75-83,66-83\n14-66,2-8\n21-73,74-89\n21-88,22-89\n40-40,60-84\n6-61,13-62\n9-96,7-7\n12-84,7-99\n14-70,9-17\n44-44,15-43\n1-55,2-56\n26-91,25-92\n76-87,36-86\n1-52,52-93\n28-41,27-40\n51-95,67-71\n49-78,34-79\n30-38,30-31\n7-99,6-6\n49-80,14-50\n7-98,9-92\n15-80,14-80\n10-86,8-11\n28-35,27-74\n1-9,10-60\n4-63,9-62\n36-37,36-36\n54-73,54-94\n24-91,92-92\n48-50,16-49\n26-41,26-41\n18-20,19-46\n11-16,16-88\n40-79,27-40\n4-53,4-53\n30-40,56-59\n97-99,2-98\n92-94,10-93\n12-64,12-64\n78-84,13-67\n25-27,26-65\n50-87,27-88\n32-57,18-33\n92-93,24-93\n1-12,12-33\n7-99,6-97\n14-58,3-57\n17-45,18-90\n9-35,29-34\n2-78,46-77\n3-39,23-39\n82-87,10-94\n64-75,64-74\n26-99,25-99\n15-97,96-98\n44-45,26-44\n52-97,34-38\n19-42,7-20\n9-72,31-73\n12-12,11-53\n4-4,6-90\n76-99,98-98\n53-55,54-95\n64-69,8-73\n11-97,14-98\n43-82,83-83\n14-47,13-47\n60-64,59-78\n87-88,1-87\n3-82,5-65\n4-4,5-98\n10-85,84-86\n37-99,37-99\n15-89,16-88\n10-97,9-99\n35-92,97-97\n77-97,78-98\n1-79,5-80\n26-35,27-65\n3-98,4-98\n63-63,1-64\n63-97,67-84\n5-7,9-69\n16-32,17-44\n12-98,13-13\n6-87,49-86\n91-91,24-92\n23-87,23-87\n10-26,16-26\n48-72,3-73\n38-39,38-61\n79-79,54-80\n42-42,43-48\n4-99,11-96\n17-70,18-49\n46-96,85-95\n13-77,14-14\n33-35,34-37\n38-43,42-43\n19-94,5-94\n24-26,25-91\n4-90,4-90\n94-99,30-40\n29-89,30-93\n63-95,20-96\n5-71,4-4\n31-54,21-54\n88-89,4-88\n5-88,2-98\n6-98,19-46\n2-63,96-98\n61-95,61-95\n22-79,21-65\n44-87,43-86\n18-93,34-92\n35-42,41-43\n5-73,16-72\n76-80,52-76\n11-20,7-75\n1-92,9-92\n81-83,45-82\n56-86,55-56\n27-62,18-22\n13-13,12-80\n30-69,31-87\n8-96,1-3\n53-53,52-78\n59-99,58-94\n48-71,5-48\n21-40,40-41\n37-64,40-65\n5-84,6-83\n4-98,12-99\n73-85,69-87\n46-79,21-47\n25-27,26-26\n9-17,8-90\n19-19,20-34\n59-98,58-58\n1-9,9-78\n3-3,4-92\n88-89,46-88\n3-91,2-91\n34-44,45-84\n1-88,2-89\n18-96,6-99\n48-79,39-83\n73-88,41-73\n3-93,6-60\n15-94,93-93\n12-80,11-79\n14-23,51-77\n23-24,3-28\n36-60,6-60\n43-48,44-57\n13-96,6-92\n54-91,53-92\n6-76,5-64\n5-28,26-29\n3-63,5-64\n20-49,30-49\n8-97,6-9\n4-72,8-71\n57-67,56-88\n51-65,25-65\n1-8,3-9\n64-91,64-99\n82-93,92-94\n53-74,4-96\n40-40,41-76\n11-85,52-84\n33-44,44-89\n3-95,95-96\n15-49,48-90\n17-96,95-97\n94-96,3-95\n2-92,3-93\n66-70,65-66\n6-82,53-82\n1-36,3-37\n78-84,71-85\n21-74,15-21\n21-68,42-89\n36-92,65-92\n59-83,59-81\n8-80,93-93\n16-93,5-13\n6-40,5-41\n2-13,13-98\n59-73,25-60\n52-75,68-74\n31-43,32-67\n22-71,22-70\n26-26,27-79\n21-22,23-87\n56-98,17-57\n48-49,13-48\n19-54,19-92\n11-38,10-11\n39-51,46-71\n2-58,57-57\n20-87,45-84\n25-37,21-26\n82-83,4-82\n72-96,73-96\n28-90,27-95\n1-4,3-98\n57-77,1-78\n27-88,21-88\n11-51,51-81\n40-94,79-93\n6-52,52-53\n17-98,18-77\n33-33,4-34\n15-38,8-8\n2-16,22-42\n1-95,96-96\n90-95,13-90\n10-63,9-97\n5-7,5-11\n6-94,93-93\n19-46,46-99\n19-72,20-73\n54-55,55-64\n10-96,7-7\n2-80,1-80\n8-96,6-9\n3-27,1-2\n6-77,5-76\n22-42,3-18\n4-5,3-4\n28-67,66-68\n1-94,99-99\n11-13,10-12\n79-80,74-79\n31-83,35-84\n63-63,59-67\n86-88,45-87\n2-93,2-52\n1-6,6-39\n16-70,27-37\n72-95,94-98\n3-82,3-81\n8-77,7-78\n7-8,9-96\n64-65,64-65\n35-88,34-89\n8-97,7-98\n2-94,4-95\n50-51,4-50\n5-98,1-4\n56-93,1-92\n33-33,34-98\n46-88,66-87\n35-97,34-97\n4-96,1-4\n68-72,69-72\n58-85,59-95\n18-96,72-97\n19-32,20-94\n16-63,15-63\n47-47,9-46\n96-97,18-97\n21-89,5-21\n9-42,20-41\n34-94,19-93\n60-76,59-80\n76-80,77-78\n13-94,23-94\n30-88,22-89\n34-34,35-87\n92-98,40-93\n20-99,20-99\n5-90,6-29\n6-78,40-79\n46-73,44-74\n1-96,37-95\n21-91,91-95\n6-85,3-85\n13-64,79-89\n41-82,81-90\n7-84,8-36\n23-30,23-30\n28-29,29-55\n98-99,13-98\n28-89,88-98\n95-98,94-94\n78-78,79-97\n81-81,81-82\n2-89,1-90\n27-29,28-62\n17-95,36-86\n1-99,3-97\n10-99,11-46\n24-53,23-83\n34-47,17-33\n7-66,7-89\n24-55,20-32\n40-41,18-40\n17-59,33-60\n59-82,60-62\n4-4,3-60\n25-94,24-94\n30-42,41-43\n69-69,5-68\n23-84,24-83\n13-71,13-76\n10-84,7-7\n57-86,51-61\n66-68,62-67\n9-85,10-86\n29-97,4-98\n95-96,46-95\n2-50,1-3\n24-72,6-24\n61-61,29-60\n24-28,24-72\n5-97,2-98\n1-88,16-72\n38-38,37-38\n18-94,66-93\n35-36,36-48\n45-98,45-99\n17-84,85-98\n26-26,25-34\n78-80,29-79\n31-43,30-30\n25-35,29-73\n20-93,27-92\n28-90,29-91\n17-32,31-32\n14-56,7-55\n39-96,3-12\n97-97,35-98\n18-34,35-51\n32-79,9-84\n30-32,13-31\n27-95,31-96\n30-30,31-44\n37-82,38-81\n8-85,7-62\n4-99,5-5\n11-13,12-64\n20-96,19-79\n52-72,29-53\n40-74,73-74\n15-54,16-36\n3-96,4-95\n13-14,16-87\n22-41,39-42\n60-65,59-59\n74-80,15-74\n61-61,4-60\n38-84,39-84\n6-16,6-6\n1-96,96-97\n1-98,97-98\n2-99,1-99\n25-96,12-24\n30-62,30-63\n4-88,5-89\n8-86,7-7\n12-97,4-97\n81-88,80-88\n8-82,6-6\n94-96,3-95\n2-98,1-99\n53-92,75-85\n18-18,19-95\n23-39,23-39\n5-94,93-93\n62-96,26-97\n1-98,35-97\n39-53,8-53\n10-67,9-66\n85-90,14-81\n10-69,11-39\n69-74,39-96\n12-35,12-35\n25-56,24-64\n20-76,75-77\n13-78,10-13\n3-43,43-80\n52-71,21-84\n40-48,33-96\n3-98,9-98\n29-38,37-39\n18-27,26-26\n6-82,4-89\n18-56,19-57\n28-76,6-77\n12-73,11-46\n10-40,11-41\n99-99,34-91\n32-91,91-94\n38-53,27-60\n36-88,35-89\n3-68,2-53\n6-85,6-85\n47-49,6-56\n31-92,30-92\n6-42,11-43\n1-1,9-64\n48-65,24-47\n18-65,2-5\n28-86,1-27\n4-26,5-94\n15-75,14-15\n11-48,10-19\n13-75,14-75\n51-90,47-89\n60-92,13-95\n14-57,14-57\n5-96,4-5\n27-33,20-32\n15-49,1-48\n44-70,43-56\n62-90,88-88\n38-58,13-80\n9-94,8-93\n42-88,42-52\n39-91,42-92\n4-74,75-81\n73-75,72-77\n49-78,50-67\n22-64,9-23\n3-89,55-60\n64-88,76-87\n29-60,60-92\n56-99,98-98\n45-96,19-95\n48-65,49-66\n59-88,90-91\n43-78,20-20\n24-65,15-24\n70-76,67-70\n24-99,25-98\n76-98,75-77\n34-56,34-56\n70-86,85-86\n33-98,32-99\n27-30,28-29\n72-99,72-97\n4-33,1-33\n22-95,21-96\n13-19,22-59\n59-77,6-59\n5-59,3-5\n20-61,60-62\n9-98,10-99\n11-91,19-86\n2-93,4-42\n33-41,61-65\n4-98,4-72\n50-68,13-51\n97-98,21-97\n21-72,22-71\n37-84,2-85\n2-85,18-85\n42-96,41-97\n29-84,52-66\n20-98,57-89\n3-91,3-91\n38-80,39-79\n89-89,11-88\n10-40,40-70\n39-80,38-87\n62-63,52-62\n1-52,2-52\n97-97,2-97\n5-59,58-58\n31-59,28-70\n27-88,21-24\n13-41,13-84\n3-42,3-42\n70-94,69-93\n16-53,15-52\n90-96,13-57\n63-75,60-76\n87-87,4-55\n3-44,4-85\n7-98,10-87\n2-65,3-65\n27-93,27-92\n35-54,34-53\n40-75,98-99\n14-14,13-53\n16-16,17-97\n39-96,41-96\n70-72,71-97\n35-35,32-36\n48-84,85-95\n7-81,11-81\n31-94,31-94\n1-2,4-72\n3-99,3-99\n92-94,21-28\n39-73,38-83\n6-57,6-57\n68-90,67-98\n9-81,10-82\n57-81,57-81\n16-59,57-60\n10-42,2-43\n14-77,12-15\n88-88,3-87\n88-89,13-89\n68-69,7-69\n63-92,92-98\n37-87,85-86\n4-56,5-22\n15-52,51-51\n92-93,74-92\n9-98,7-10\n17-17,18-53\n55-88,61-72\n38-81,65-78\n98-99,59-73\n17-22,18-22\n69-94,68-69\n84-85,6-84\n12-12,13-95\n8-34,7-8\n2-38,3-38\n20-29,28-80\n21-52,22-52\n36-91,90-92\n5-90,4-91\n1-41,1-36\n3-76,10-98\n14-41,2-14\n18-64,19-64\n37-93,83-92\n31-36,32-60\n53-83,47-84\n2-89,70-77\n28-83,84-84\n31-59,58-71\n10-98,10-87\n19-80,20-81\n11-17,9-18\n29-76,48-52\n10-33,33-65\n20-83,68-99\n14-43,13-13\n44-71,62-70\n59-63,49-64\n14-94,94-95\n5-89,2-2\n83-95,84-95\n2-9,8-93\n63-69,68-68\n73-75,5-74\n82-92,91-93\n5-5,4-57\n35-39,35-83\n71-83,56-83\n87-87,8-88\n95-98,2-30\n10-60,59-89\n13-23,25-93\n73-86,22-85\n32-47,46-90\n5-79,3-16\n20-92,28-69\n30-31,19-31\n41-70,9-36\n1-49,2-98\n1-96,41-96\n44-50,44-71\n1-28,2-27\n13-93,74-92\n37-38,31-37\n4-79,3-80\n14-50,37-37\n5-68,46-68\n23-63,22-63\n3-94,1-3")

(defn parse [s]
  (-> s (str/split #",")
    (->>
      (map #(str/split % #"-"))
      (map #(map u/to-int %)))))

(defn f? [[[a b] [A B]]] (or (<= a A B b) (<= A a b B)))
(defn g? [[[a b] [A B]]] (not (or (< b A) (< B a))))


(defn p1 [ss] (->> ss str/split-lines (map parse) (filter f?) count))
(defn p2 [ss] (->> ss str/split-lines (map parse) (filter g?) count))

(assert (= 2 (p1 sample)))
(assert (= 487 (p1 input)))

(assert (= 4 (p2 sample)))
(assert (= 849 (p2 input)))
