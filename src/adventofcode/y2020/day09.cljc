(ns adventofcode.y2020.day09
  (:require [clojure.string :as str]))

(def i (mapv read-string (str/split-lines "23\n3\n36\n14\n50\n8\n2\n44\n30\n37\n20\n5\n34\n41\n31\n39\n28\n24\n49\n42\n22\n4\n45\n46\n32\n6\n35\n7\n26\n15\n21\n8\n9\n12\n25\n10\n11\n13\n14\n16\n17\n57\n18\n64\n19\n20\n22\n33\n27\n23\n24\n28\n29\n30\n38\n31\n37\n35\n21\n26\n44\n25\n32\n34\n36\n69\n40\n51\n39\n43\n41\n45\n46\n63\n49\n54\n47\n66\n64\n55\n52\n65\n53\n57\n59\n83\n61\n92\n70\n97\n79\n80\n82\n84\n86\n87\n91\n93\n96\n101\n99\n148\n105\n107\n109\n110\n112\n114\n116\n166\n204\n191\n196\n149\n159\n161\n198\n240\n170\n173\n178\n190\n219\n314\n200\n206\n222\n217\n216\n223\n224\n428\n412\n265\n319\n404\n349\n357\n308\n446\n331\n670\n343\n348\n384\n368\n407\n514\n406\n737\n628\n433\n439\n440\n584\n667\n596\n741\n749\n639\n918\n651\n656\n674\n727\n679\n691\n1040\n781\n1342\n775\n813\n839\n1023\n1406\n873\n1455\n1131\n1114\n1420\n1235\n1247\n1440\n1347\n1290\n1307\n2366\n1330\n1353\n1370\n1454\n1466\n2071\n1556\n2467\n1588\n1652\n2701\n1896\n2723\n2895\n2245\n2444\n3814\n2577\n2617\n2537\n2637\n2597\n2620\n2807\n2700\n5140\n3208\n4289\n5214\n3054\n5168\n3144\n6198\n5498\n4353\n4141\n4513\n4689\n4782\n4822\n9511\n5174\n9604\n5134\n5681\n6761\n7096\n5320\n7561\n5844\n7833\n6262\n7343\n14386\n7195\n7285\n8318\n10951\n8866\n8494\n8654\n10978\n11878\n15627\n11895\n14538\n15513\n10454\n12876\n13129\n12106\n14480\n11164\n13039\n13547\n15837\n15689\n27356\n15779\n15603\n24992\n19269\n21742\n17148\n19472\n36417\n31628\n21618\n28503\n22349\n24293\n24203\n22560\n42959\n23270\n32927\n24711\n38539\n60710\n35161\n31292\n31382\n32751\n34872\n35075\n41351\n45619\n36620\n43765\n41090\n54188\n47473\n43967\n44909\n99097\n67162\n85318\n57432\n47981\n54562\n56003\n67912\n62674\n85999\n79363\n64043\n92890\n67623\n100663\n71695\n80385\n77710\n98155\n91440\n127698\n92382\n88876\n131955\n99471\n167825\n102543\n110565\n120046\n103984\n117236\n118677\n126717\n151550\n194946\n167094\n131666\n148008\n139318\n149405\n202947\n158095\n169150\n226188\n257995\n202014\n188347\n199441\n263621\n321663\n206527\n229242\n227801\n224030\n221220\n270984\n245394\n274725\n279674\n281071\n287326\n288723\n297413\n379315\n307500\n357536\n327245\n390370\n387788\n423471\n390361\n572138\n405968\n427747\n619076\n495014\n445250\n449021\n502291\n466614\n516378\n520119\n562051\n560745\n568397\n576049\n586136\n604913\n634745\n776266\n717615\n717606\n778149\n793756\n856975\n851218\n876768\n833715\n872997\n894271\n911864\n1184229\n1165658\n1338894\n982992\n1146881\n1130448\n1279657\n1383062\n1144446\n1568824\n1191049\n1352360\n1412894\n2003856\n1435221\n2038655\n1571905\n2574111\n1690690\n2113440\n3682264\n1706712\n1767268\n1806135\n2058745\n2127438\n2129873\n2277329\n2174041\n3318487\n3140729\n2692551\n2496806\n3043050\n2543409\n2603943\n3158495\n5009177\n3007126\n3125911\n4240878\n3473980\n3397402\n4336074\n3512847\n3573403\n3880753\n3826013\n3864880\n5332536\n4257311\n5790176\n4451370\n4670847\n5040215\n5100749\n5147352\n5586459\n7677973\n5550535\n5611069\n6133037\n7299993\n8437617\n6699314\n9589847\n10711818\n7223415\n7086250\n7706766\n7399416\n7690893\n8083324\n8122191\n8928158\n8708681\n9122217\n9491585\n9711062\n10140964\n10248101\n10697887\n14708676\n11161604\n14539227\n15306739\n15828957\n14406080\n13785564\n13922729\n14930181\n14309665\n17205541\n24654181\n15090309\n15482740\n16813110\n17011482\n24212526\n17636839\n19202647\n24547044\n19632549\n19959163\n20389065\n31550709\n21859491\n24947168\n25084333\n28095229\n29229468\n28191644\n31941663\n27708293\n32727148\n29239846\n40136921\n41418067\n47424403\n37596002\n35115289\n33824592\n34648321\n39591712\n36839486\n38835196\n40021614\n40348228\n41818654\n45336233\n46806659\n56948139\n60918792\n52792626\n55803522\n55899937\n57431490\n41682220\n67842437\n84927945\n78426908\n68472913\n109740765\n68939881\n72244323\n76861100\n70664078\n71487807\n82175719\n75674682\n180404843\n80369842\n82030448\n87018453\n160602627\n113926543\n136315350\n94474846\n97485742\n124372850\n97582157\n112346298\n109524657\n144147595\n139603959\n226272841\n154274771\n140427688\n141184204\n142151885\n157850401\n242633075\n238766361\n156044524\n162400290\n167388295\n169048901\n207010399\n196543110\n191960588\n241729752\n206821144\n251760513\n195067899\n303584494\n406035284\n266621069\n354360878\n280788163\n280031647\n281611892\n282579573\n308572499\n283336089\n449000187\n436797651\n318444814\n323432819\n325093425\n489400717\n375870045\n361009489\n387028487\n664593983\n398781732\n524309325\n401889043\n475856062\n605125072\n546652716\n547409232\n562400055\n564191465\n891289760\n945434448\n606768908\n659206134\n1096169625\n930201727\n641877633\n1532967276\n794300876\n648526244\n686102914\n748037976\n1123908021\n907662205\n785810219\n1445016353\n1008657951\n877745105\n949298275\n1022508778\n1094061948\n1109052771\n1109809287\n1756695927\n1265975042\n1248646541\n1255295152\n1290403877\n1578727971\n1334629158\n1480403790\n1327980547\n1396564220\n1434140890\n1772434265\n2486390176\n1957956226\n1663555324\n1894862990\n1735108494\n1827043380\n1886403056\n1900253883\n1971807053\n2116570726\n2203114719\n2218862058\n2358455828\n2503941693\n2514621583\n2539050418\n2618384424\n3465131027\n3012868861\n4347498019\n2808384337\n2724544767\n2830705110\n4747977355\n3398663818\n3490598704\n3549958380\n3706915547\n3562151874\n4030158099\n6562827241\n3786656939\n4802512163\n4510857471\n4319685445\n4421976777\n5122326117\n5449089534\n5042992111\n5053672001\n5157434842\n5342929191\n5532929104\n5555249877\n8349843544\n7810284149\n6123208585\n6321303814\n7197514251\n6889262522\n7112110254\n7256873927\n8864350389\n14419600266\n7816815038\n8106342384\n9668292313\n16166658582\n13228668501\n8741662222\n10677575994\n10096664112\n14987558974\n10200426953\n21970330723\n10500364033\n10875858295\n11656137689\n11678458462\n12444512399\n15853772476\n13012471107\n13578177741\n19419238216\n15073688965\n14368984181\n23512835140\n15923157422\n16558477260\n16848004606\n24595434698\n18409954535\n18838326334\n18942089175\n20972522407\n20297091065\n21076285248\n21376222328\n21878885415\n22156501722\n22178822495\n39366607616\n27518201364\n27381455288\n28935628529\n31988132276\n39716329281\n43129024129\n29442673146\n30292141603\n30927461441\n59863089970\n35686330940\n45494105789\n37248280869\n37352043710\n37780415509\n49869550616\n39239180240\n47678546353\n41373376313\n84926827222\n43532724050\n44035387137\n44335324217\n49560277783\n74327528740\n54899656652\n59369587564\n58378301675\n61430805422\n80612556553\n138990858228\n67540422472\n61219603044\n66613792381\n73466746449\n73038374650\n74600324579\n75028696378\n75132459219\n77019595749\n82771904290\n155810278940\n92013870570\n84906100363\n87568111187\n87868048267\n93595664920\n93895602000\n133969912143\n135819927623\n113277958327\n117747889239\n119597904719\n249097885950\n127833395425\n142569118850\n134257977694\n139652167031\n140080538830\n146505121099\n148067071028\n149629020957\n275900466453\n152152054968\n159791500039\n167678004653\n211343554159\n172474211550\n178801702363\n207173560327\n181463713187\n347254099157\n211643491239\n231025847566\n247535936021\n257400056270\n237345793958\n301781075925\n262091373119\n267485562456\n282325048722\n273910144725\n279732705861\n413990683555\n417114583413\n356802581284\n309420520996\n319830059621\n327469504692\n366965060366\n780955743921\n390445193602\n539126869883\n866596374575\n591745569718\n418809507145\n1097622222141\n442669338805\n468371641524\n484881729979\n494745850228\n499437167077\n541395707181\n529576935575\n549810611178\n553642850586\n1280587058130\n804166371224\n856660022360\n629250580617\n809634399171\n1018182252702\n647299564313\n694434565058\n1286180134776\n809254700747\n833114532407\n2383802356917\n887181148669\n861478845950\n1014458665554\n927551068784\n1391055781525\n953253371503\n979627580207\n994183017305\n1040832874258\n1070972642756\n1433416951841\n1103453461764\n1200942414899\n1691347519893\n1276550144930\n3584744771816\n1438505281364\n1456933963484\n1534480712982\n2119294667183\n1503689265805\n1642369233154\n1880804440287\n1694593378357\n1964932307714\n1990634610433\n2318606850309\n2431888655783\n1907178648991\n3389579493065\n1932880951710\n2020460454465\n2451116980789\n2111805517014\n2304395876663\n2380003606694\n2477492559829\n2639447696263\n4684399483357\n2715055426294\n3364112612475\n3345683930355\n4339067304774\n3038169978787\n5515662538616\n4736284532446\n3336962611511\n3992609957301\n3601772027348\n3840059600701\n6965884639823\n3953341406175\n3927639103456\n4018984166005\n5116940256092\n5622232481813\n4562922497803\n4416201393677\n6682646541866\n4781888436492\n8553832517403\n5192547986123\n5354503122557\n6383853909142\n5753225405081\n8164694525151\n6375132590298\n8755268698451\n6639942006135\n6938734638859\n7355946777516\n7264601714967\n10893523743279\n7441831628049\n8709527539948\n9044579359548\n7880980509631\n7946623269461\n9608749379800\n12435871946947\n8979123891480\n15139122607593\n9198089830169\n9974436422615\n11738357031699\n13109172182597\n10547051108680\n20047906821456\n12128357995379\n12393167411216\n17799848057999\n13731079367814\n15648262178807\n13578676644994\n14203336353826\n20382495216408\n17489729889431\n19172526252784\n15322812137680\n16860104401111\n20274147920847\n24301936029160\n19684980301160\n22675409104059\n22940218519896\n18177213721649\n36908011222567\n19745140938849\n23866715027078\n23656223291277\n24125727753674\n43551695328238\n25707034640373\n24521525406595\n25971844056210\n27309756012808\n35393403117656\n27782012998820\n28901488782674\n32812542027111\n37872225105839\n32182916538791\n33500025859329\n35007792438840\n35037318122760\n37862194022809\n42043928748727\n41833437012926\n37922354660498\n52303538405415\n42302941475323\n43401364230126\n43870868692523\n47522938318355\n47781951044951\n48647253160269\n86173810167846\n59492672551599\n60979636495050\n53281600069018")))

i
;p1
(loop [nums (->> i (take 25) set)
       todo (->> i (drop 25))
       head i]
  (if-let [x (first todo)]
    (if-not (some #(contains? (disj nums %) (- x %)) nums)
      x
      (recur
        (-> nums (disj (first head)) (conj x))
        (rest todo)
        (rest head)))))

41682220

(assert (count (set i)) (count i))
;p2
(let [X 41682220]
  (loop [left  i
         mid   (set (take 2 i))
         right (drop 2 i)]
    (let [sum (reduce + mid)
          len (count mid)]
      (cond
        (< len 2) (recur left (conj mid (first right)) (rest right))
        (< sum X) (recur left (conj mid (first right)) (rest right))
        (> sum X) (recur (rest left) (disj mid (first left)) right)
        (= sum X) (+ (reduce min mid) (reduce max mid))
        (empty? right) :fail))))

5388976