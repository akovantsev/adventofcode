(ns adventofcode.2017.day12
  (:require [clojure.string :as str]
            [adventofcode.utils :as u]
            [clojure.set :as set]))


(def input "0 <-> 122, 874, 1940\n1 <-> 1099\n2 <-> 743\n3 <-> 594, 1258\n4 <-> 4, 1473\n5 <-> 109, 628, 1133, 1605\n6 <-> 470, 561, 600, 1272, 1634\n7 <-> 7, 1058, 1074, 1136\n8 <-> 879\n9 <-> 9\n10 <-> 10, 1736\n11 <-> 148, 1826\n12 <-> 774, 1394, 1495\n13 <-> 178, 410\n14 <-> 666, 763, 1696\n15 <-> 793, 1446, 1754, 1993\n16 <-> 1477\n17 <-> 1891, 1970\n18 <-> 476, 1095\n19 <-> 19\n20 <-> 581, 1380, 1817, 1877\n21 <-> 746, 1253\n22 <-> 830, 1021\n23 <-> 1115\n24 <-> 89, 1436\n25 <-> 759, 821\n26 <-> 40, 1254\n27 <-> 553, 1137, 1960\n28 <-> 100, 808\n29 <-> 279, 1223, 1591, 1726\n30 <-> 236, 325, 769, 1132\n31 <-> 425, 1377\n32 <-> 611, 1047\n33 <-> 751, 1797, 1828, 1921\n34 <-> 1563, 1681\n35 <-> 428\n36 <-> 265, 1837\n37 <-> 265, 365, 1455\n38 <-> 1600, 1690\n39 <-> 331\n40 <-> 26, 560, 1512\n41 <-> 911, 1991\n42 <-> 835\n43 <-> 680\n44 <-> 1522\n45 <-> 486, 1794\n46 <-> 170, 334, 944, 1169\n47 <-> 1086\n48 <-> 274, 924\n49 <-> 1664\n50 <-> 721\n51 <-> 1885\n52 <-> 1143, 1205\n53 <-> 148, 696\n54 <-> 1637\n55 <-> 936, 1781\n56 <-> 342, 1212\n57 <-> 911\n58 <-> 692, 1456\n59 <-> 59\n60 <-> 463, 570, 1038, 1711\n61 <-> 824, 1008, 1942\n62 <-> 165, 1926\n63 <-> 1689\n64 <-> 64, 321\n65 <-> 98, 116, 1082\n66 <-> 1426, 1497\n67 <-> 502, 951, 1514\n68 <-> 215, 610, 803\n69 <-> 264, 1660\n70 <-> 417, 648, 1142\n71 <-> 1937\n72 <-> 744, 1158\n73 <-> 466\n74 <-> 74, 673\n75 <-> 640, 1874\n76 <-> 575, 708, 1347, 1488\n77 <-> 435, 1648\n78 <-> 412\n79 <-> 347\n80 <-> 807\n81 <-> 176, 394\n82 <-> 366, 928\n83 <-> 737\n84 <-> 84, 1537\n85 <-> 1325\n86 <-> 546\n87 <-> 678, 941, 1229\n88 <-> 1325\n89 <-> 24, 89\n90 <-> 431, 988, 1453\n91 <-> 825, 957, 1249\n92 <-> 937, 1516\n93 <-> 1840\n94 <-> 916, 1445\n95 <-> 1628, 1998\n96 <-> 123\n97 <-> 355\n98 <-> 65\n99 <-> 425, 771, 1050\n100 <-> 28, 100\n101 <-> 337, 1257\n102 <-> 270, 1754\n103 <-> 103, 229\n104 <-> 157, 916\n105 <-> 1705\n106 <-> 1165\n107 <-> 1646\n108 <-> 1082\n109 <-> 5\n110 <-> 485, 1185\n111 <-> 944, 1249\n112 <-> 112, 1056\n113 <-> 1219\n114 <-> 129, 617\n115 <-> 422\n116 <-> 65\n117 <-> 200, 1802\n118 <-> 243, 1507\n119 <-> 732, 1103\n120 <-> 160\n121 <-> 320, 336\n122 <-> 0, 582, 1931\n123 <-> 96, 885, 1126, 1914\n124 <-> 124, 413\n125 <-> 125\n126 <-> 367, 655\n127 <-> 1290\n128 <-> 1085\n129 <-> 114, 1343, 1805\n130 <-> 130, 1415\n131 <-> 1626, 1734\n132 <-> 296, 573, 1575\n133 <-> 1713\n134 <-> 1243, 1530\n135 <-> 1048\n136 <-> 153, 1209\n137 <-> 137, 331\n138 <-> 555, 1350\n139 <-> 1035, 1345\n140 <-> 393, 688\n141 <-> 1037, 1998\n142 <-> 736\n143 <-> 716, 1362\n144 <-> 1319\n145 <-> 318, 445, 1471, 1608\n146 <-> 146, 294\n147 <-> 714\n148 <-> 11, 53\n149 <-> 364, 854, 1254\n150 <-> 675, 1090\n151 <-> 189, 1411, 1688\n152 <-> 683, 1614\n153 <-> 136, 1328, 1648\n154 <-> 584, 1656\n155 <-> 1972\n156 <-> 1351\n157 <-> 104, 1638\n158 <-> 165\n159 <-> 444, 1812\n160 <-> 120, 859\n161 <-> 984, 1769, 1943\n162 <-> 1098\n163 <-> 618\n164 <-> 697, 922, 1688\n165 <-> 62, 158, 1452, 1977\n166 <-> 166, 1914\n167 <-> 1996\n168 <-> 260, 843, 1057, 1433\n169 <-> 406, 736, 924\n170 <-> 46\n171 <-> 173, 833, 1104, 1149\n172 <-> 1429\n173 <-> 171, 1423\n174 <-> 174, 332\n175 <-> 655, 839\n176 <-> 81, 176, 1264\n177 <-> 177\n178 <-> 13, 1162, 1182, 1951\n179 <-> 842, 1620\n180 <-> 1294, 1442, 1809\n181 <-> 1633, 1783\n182 <-> 182, 456\n183 <-> 685\n184 <-> 760, 1974\n185 <-> 287, 775\n186 <-> 917, 1541\n187 <-> 412, 1119\n188 <-> 395\n189 <-> 151, 1370, 1792\n190 <-> 1255, 1674\n191 <-> 764, 1010\n192 <-> 192, 607, 1717\n193 <-> 1001, 1944\n194 <-> 625\n195 <-> 623\n196 <-> 1882\n197 <-> 1275\n198 <-> 1069\n199 <-> 1138, 1880\n200 <-> 117\n201 <-> 1605\n202 <-> 1041, 1044\n203 <-> 207, 301, 815, 1311\n204 <-> 204, 1711\n205 <-> 1298, 1562, 1602\n206 <-> 228\n207 <-> 203, 1480, 1713\n208 <-> 786, 1844\n209 <-> 1291, 1351, 1747\n210 <-> 1320\n211 <-> 587, 1340\n212 <-> 587, 676\n213 <-> 886\n214 <-> 1549\n215 <-> 68, 1115, 1371, 1701\n216 <-> 1127\n217 <-> 312\n218 <-> 466, 1072, 1709\n219 <-> 527\n220 <-> 793\n221 <-> 1314, 1800\n222 <-> 1941\n223 <-> 1911\n224 <-> 224, 528\n225 <-> 1030, 1084\n226 <-> 569, 1599\n227 <-> 658\n228 <-> 206, 579, 800, 1381\n229 <-> 103, 1975\n230 <-> 1068\n231 <-> 937\n232 <-> 428\n233 <-> 969, 1258\n234 <-> 1824\n235 <-> 1218\n236 <-> 30, 1410, 1470, 1651\n237 <-> 815\n238 <-> 477, 1518, 1869\n239 <-> 985, 1911\n240 <-> 809, 1047\n241 <-> 1379, 1577, 1692, 1757\n242 <-> 1127\n243 <-> 118\n244 <-> 440, 747, 771, 1051\n245 <-> 644, 725, 1332, 1862\n246 <-> 395, 1168\n247 <-> 1118\n248 <-> 1462\n249 <-> 737\n250 <-> 1254\n251 <-> 491, 1129\n252 <-> 623\n253 <-> 1046, 1872\n254 <-> 1473\n255 <-> 1220, 1672\n256 <-> 1290, 1838\n257 <-> 474, 1708, 1945\n258 <-> 728, 1297\n259 <-> 374, 464, 1637\n260 <-> 168, 1699\n261 <-> 677, 1164\n262 <-> 1507\n263 <-> 564\n264 <-> 69, 264, 912\n265 <-> 36, 37\n266 <-> 1362\n267 <-> 267\n268 <-> 275, 1873\n269 <-> 449, 766\n270 <-> 102\n271 <-> 1139, 1156\n272 <-> 369, 584\n273 <-> 311, 969\n274 <-> 48, 667\n275 <-> 268, 672, 1687\n276 <-> 1609\n277 <-> 490, 1252\n278 <-> 1236, 1984\n279 <-> 29\n280 <-> 932, 1860\n281 <-> 372, 638, 1311\n282 <-> 1199, 1308\n283 <-> 1938\n284 <-> 315, 1375, 1799\n285 <-> 1377, 1613\n286 <-> 1661\n287 <-> 185, 1248\n288 <-> 409, 1457\n289 <-> 1025\n290 <-> 606, 1486, 1925\n291 <-> 734, 1407\n292 <-> 330\n293 <-> 360, 1231\n294 <-> 146, 1887\n295 <-> 1237, 1733\n296 <-> 132, 296, 621\n297 <-> 1493, 1730\n298 <-> 1958\n299 <-> 696\n300 <-> 1300\n301 <-> 203\n302 <-> 1188, 1349\n303 <-> 750, 1701\n304 <-> 304, 503\n305 <-> 402, 630, 636, 1479\n306 <-> 1007, 1350, 1502\n307 <-> 1787\n308 <-> 1485\n309 <-> 479, 521\n310 <-> 1415\n311 <-> 273, 1942\n312 <-> 217, 387, 1357\n313 <-> 905, 1606\n314 <-> 1337, 1627\n315 <-> 284, 1509\n316 <-> 1809\n317 <-> 490, 1053, 1904\n318 <-> 145, 1789\n319 <-> 926, 1180\n320 <-> 121, 1454, 1764\n321 <-> 64, 725\n322 <-> 762, 1178\n323 <-> 918, 1064, 1957\n324 <-> 1901\n325 <-> 30\n326 <-> 483, 1827\n327 <-> 1360\n328 <-> 546, 1576\n329 <-> 526, 1667\n330 <-> 292, 823\n331 <-> 39, 137, 979\n332 <-> 174, 703, 914\n333 <-> 333, 1364\n334 <-> 46\n335 <-> 650\n336 <-> 121, 1814\n337 <-> 101\n338 <-> 740, 1239\n339 <-> 1595\n340 <-> 1076, 1544\n341 <-> 341, 623, 1540\n342 <-> 56\n343 <-> 367\n344 <-> 1547, 1878\n345 <-> 528\n346 <-> 346, 626, 1036\n347 <-> 79, 1052\n348 <-> 368, 1950\n349 <-> 631, 1765\n350 <-> 602\n351 <-> 1503, 1541, 1615, 1684\n352 <-> 1341\n353 <-> 824\n354 <-> 703, 1868\n355 <-> 97, 480, 566, 1804\n356 <-> 648, 814\n357 <-> 1656\n358 <-> 504\n359 <-> 763\n360 <-> 293, 1296\n361 <-> 361\n362 <-> 1892\n363 <-> 524\n364 <-> 149, 1268\n365 <-> 37, 1392, 1667\n366 <-> 82, 606\n367 <-> 126, 343, 677\n368 <-> 348, 500, 1101, 1300\n369 <-> 272, 527, 1785, 1833\n370 <-> 370\n371 <-> 1352, 1664\n372 <-> 281\n373 <-> 860, 1026, 1504\n374 <-> 259, 919, 1635\n375 <-> 990, 1489, 1835\n376 <-> 1389\n377 <-> 1063, 1750\n378 <-> 423\n379 <-> 1510\n380 <-> 1983\n381 <-> 517\n382 <-> 1792\n383 <-> 814\n384 <-> 1826\n385 <-> 1769\n386 <-> 1632, 1931\n387 <-> 312, 1206, 1961\n388 <-> 868, 1713\n389 <-> 721, 1781\n390 <-> 604\n391 <-> 493, 1691\n392 <-> 1331\n393 <-> 140\n394 <-> 81, 1836\n395 <-> 188, 246, 1171, 1388\n396 <-> 981, 1475, 1617\n397 <-> 397\n398 <-> 931\n399 <-> 1815\n400 <-> 1245\n401 <-> 1011\n402 <-> 305, 1911\n403 <-> 709\n404 <-> 606, 709, 1067, 1988\n405 <-> 1334, 1854\n406 <-> 169, 1552\n407 <-> 563\n408 <-> 813\n409 <-> 288, 409, 445\n410 <-> 13, 577\n411 <-> 1691\n412 <-> 78, 187, 1089\n413 <-> 124\n414 <-> 803, 1858\n415 <-> 415, 1289\n416 <-> 549, 1519\n417 <-> 70\n418 <-> 1866\n419 <-> 419, 680\n420 <-> 1727\n421 <-> 676, 1365\n422 <-> 115, 467\n423 <-> 378, 1470\n424 <-> 436, 929, 1311\n425 <-> 31, 99\n426 <-> 934\n427 <-> 596, 675, 936, 1580\n428 <-> 35, 232, 1027\n429 <-> 682, 1498\n430 <-> 430\n431 <-> 90\n432 <-> 432, 1607\n433 <-> 1312\n434 <-> 1023, 1118\n435 <-> 77, 435, 1280\n436 <-> 424, 894\n437 <-> 586, 1543\n438 <-> 1118\n439 <-> 439\n440 <-> 244\n441 <-> 441, 605\n442 <-> 1274\n443 <-> 443, 556\n444 <-> 159\n445 <-> 145, 409\n446 <-> 1258\n447 <-> 644, 940\n448 <-> 1271, 1480\n449 <-> 269, 1398\n450 <-> 871, 1094\n451 <-> 589, 1075\n452 <-> 755\n453 <-> 1518\n454 <-> 613, 796\n455 <-> 593\n456 <-> 182, 1321, 1938\n457 <-> 662, 1432\n458 <-> 916, 1812\n459 <-> 459\n460 <-> 1920, 1926\n461 <-> 1243, 1808, 1866\n462 <-> 617, 693\n463 <-> 60, 908\n464 <-> 259, 1178\n465 <-> 600\n466 <-> 73, 218\n467 <-> 422, 531, 750, 1476\n468 <-> 468\n469 <-> 901, 1204\n470 <-> 6\n471 <-> 755, 1257\n472 <-> 514\n473 <-> 873, 928\n474 <-> 257, 784\n475 <-> 1776\n476 <-> 18, 1314\n477 <-> 238\n478 <-> 1825\n479 <-> 309, 1605\n480 <-> 355\n481 <-> 1308\n482 <-> 807\n483 <-> 326, 619, 1098, 1776\n484 <-> 1837\n485 <-> 110, 525, 1601, 1893\n486 <-> 45, 1581\n487 <-> 1791\n488 <-> 758\n489 <-> 978\n490 <-> 277, 317, 792\n491 <-> 251, 1582\n492 <-> 945, 1028\n493 <-> 391, 1786\n494 <-> 1661\n495 <-> 534, 1255\n496 <-> 690, 1480\n497 <-> 631, 1195\n498 <-> 892, 903\n499 <-> 1522, 1941\n500 <-> 368, 1449, 1624\n501 <-> 706, 915, 1115\n502 <-> 67\n503 <-> 304\n504 <-> 358, 1431, 1609, 1685\n505 <-> 515\n506 <-> 1347\n507 <-> 624, 831\n508 <-> 907\n509 <-> 1127, 1970\n510 <-> 821, 1599\n511 <-> 763, 846\n512 <-> 1779\n513 <-> 537, 1033\n514 <-> 472, 1068, 1888\n515 <-> 505, 515\n516 <-> 1363, 1644\n517 <-> 381, 680\n518 <-> 853\n519 <-> 1703\n520 <-> 1851\n521 <-> 309\n522 <-> 1831\n523 <-> 1561\n524 <-> 363, 1282, 1852\n525 <-> 485, 1383\n526 <-> 329, 876, 1399\n527 <-> 219, 369, 1086\n528 <-> 224, 345, 1243\n529 <-> 719, 845, 980, 1778\n530 <-> 530, 535\n531 <-> 467\n532 <-> 603, 1522\n533 <-> 533\n534 <-> 495, 1020\n535 <-> 530, 639\n536 <-> 789\n537 <-> 513, 932, 1102\n538 <-> 653, 784, 807\n539 <-> 1186\n540 <-> 1224\n541 <-> 1068, 1320\n542 <-> 1332\n543 <-> 543, 1177\n544 <-> 1404, 1567\n545 <-> 842\n546 <-> 86, 328, 1785\n547 <-> 892, 1973\n548 <-> 1686\n549 <-> 416, 595, 1735\n550 <-> 1928\n551 <-> 850\n552 <-> 552\n553 <-> 27\n554 <-> 554\n555 <-> 138\n556 <-> 443, 1389\n557 <-> 748, 1656\n558 <-> 758\n559 <-> 596, 1812\n560 <-> 40\n561 <-> 6\n562 <-> 562, 627, 1715\n563 <-> 407, 776, 999\n564 <-> 263, 633, 962, 1130, 1653\n565 <-> 998\n566 <-> 355\n567 <-> 676, 1358\n568 <-> 871, 1313, 1853\n569 <-> 226\n570 <-> 60, 1423\n571 <-> 571, 880\n572 <-> 778, 896, 1251\n573 <-> 132, 685\n574 <-> 1212\n575 <-> 76, 1320, 1593\n576 <-> 1237, 1760\n577 <-> 410\n578 <-> 1150, 1511, 1668\n579 <-> 228, 1219, 1244\n580 <-> 701\n581 <-> 20\n582 <-> 122, 1525\n583 <-> 628, 1802\n584 <-> 154, 272\n585 <-> 698, 743, 1466, 1521\n586 <-> 437, 1394\n587 <-> 211, 212, 1856\n588 <-> 1989\n589 <-> 451\n590 <-> 644, 1192\n591 <-> 591\n592 <-> 984, 1880\n593 <-> 455, 789\n594 <-> 3, 1526, 1844, 1902\n595 <-> 549, 715, 1981\n596 <-> 427, 559, 1316\n597 <-> 1043, 1225\n598 <-> 932\n599 <-> 1064, 1065\n600 <-> 6, 465\n601 <-> 756, 946, 1050, 1570\n602 <-> 350, 1809\n603 <-> 532, 1010, 1060\n604 <-> 390, 729\n605 <-> 441\n606 <-> 290, 366, 404\n607 <-> 192\n608 <-> 1826\n609 <-> 953\n610 <-> 68\n611 <-> 32, 868\n612 <-> 1213\n613 <-> 454, 720\n614 <-> 1872\n615 <-> 615, 829, 1762\n616 <-> 990, 1784\n617 <-> 114, 462\n618 <-> 163, 1508\n619 <-> 483\n620 <-> 686, 1446\n621 <-> 296\n622 <-> 622\n623 <-> 195, 252, 341, 780, 1078\n624 <-> 507\n625 <-> 194, 1329\n626 <-> 346\n627 <-> 562\n628 <-> 5, 583, 1876\n629 <-> 1027, 1342, 1827\n630 <-> 305, 1829\n631 <-> 349, 497, 1248, 1728\n632 <-> 1552\n633 <-> 564\n634 <-> 875, 1513\n635 <-> 1150, 1410\n636 <-> 305\n637 <-> 637\n638 <-> 281, 1877\n639 <-> 535\n640 <-> 75, 649, 804\n641 <-> 967, 1739\n642 <-> 1114, 1739\n643 <-> 897, 981\n644 <-> 245, 447, 590, 960\n645 <-> 788, 1064, 1342\n646 <-> 1217\n647 <-> 675, 910, 1021\n648 <-> 70, 356, 1893\n649 <-> 640\n650 <-> 335, 1903\n651 <-> 651\n652 <-> 758, 1836\n653 <-> 538, 1515\n654 <-> 902, 1322\n655 <-> 126, 175\n656 <-> 945, 1247\n657 <-> 1957\n658 <-> 227, 1231\n659 <-> 737\n660 <-> 915\n661 <-> 692, 1299\n662 <-> 457, 962, 1081\n663 <-> 1410, 1852\n664 <-> 664, 1969\n665 <-> 872\n666 <-> 14\n667 <-> 274, 1871\n668 <-> 994\n669 <-> 1419, 1657\n670 <-> 1275\n671 <-> 671, 826\n672 <-> 275, 928, 1330, 1619\n673 <-> 74, 737, 1208\n674 <-> 1863\n675 <-> 150, 427, 647\n676 <-> 212, 421, 567\n677 <-> 261, 367, 677, 1023, 1306, 1405, 1725\n678 <-> 87\n679 <-> 1905\n680 <-> 43, 419, 517, 1232, 1382, 1395, 1875\n681 <-> 1845\n682 <-> 429, 1368, 1625, 1990\n683 <-> 152, 924, 1234\n684 <-> 1247, 1628\n685 <-> 183, 573\n686 <-> 620, 1184, 1867\n687 <-> 1080, 1636\n688 <-> 140, 1205, 1363\n689 <-> 1418, 1494\n690 <-> 496\n691 <-> 1013, 1178\n692 <-> 58, 661, 1324, 1366\n693 <-> 462, 693, 852\n694 <-> 694\n695 <-> 717\n696 <-> 53, 299, 1979\n697 <-> 164\n698 <-> 585\n699 <-> 1532\n700 <-> 855\n701 <-> 580, 744\n702 <-> 1198, 1240\n703 <-> 332, 354\n704 <-> 1361\n705 <-> 1101\n706 <-> 501\n707 <-> 707\n708 <-> 76, 795, 1235, 1302\n709 <-> 403, 404\n710 <-> 806, 1358\n711 <-> 711\n712 <-> 924, 1569, 1990\n713 <-> 1870\n714 <-> 147, 1507\n715 <-> 595\n716 <-> 143, 1039\n717 <-> 695, 1979\n718 <-> 1476\n719 <-> 529, 1061\n720 <-> 613\n721 <-> 50, 389, 1765\n722 <-> 1058\n723 <-> 723, 773, 1214\n724 <-> 724\n725 <-> 245, 321\n726 <-> 938, 1010, 1366, 1670\n727 <-> 1706\n728 <-> 258, 1264\n729 <-> 604, 729, 1396\n730 <-> 1184\n731 <-> 1524\n732 <-> 119, 1962\n733 <-> 1665, 1761\n734 <-> 291\n735 <-> 1022\n736 <-> 142, 169, 1855\n737 <-> 83, 249, 659, 673\n738 <-> 933\n739 <-> 1461, 1637\n740 <-> 338, 1065\n741 <-> 857, 943, 1100\n742 <-> 742, 1400\n743 <-> 2, 585, 743\n744 <-> 72, 701, 1417, 1588\n745 <-> 745\n746 <-> 21, 1433, 1714\n747 <-> 244\n748 <-> 557\n749 <-> 1225\n750 <-> 303, 467\n751 <-> 33\n752 <-> 851\n753 <-> 1398\n754 <-> 1293\n755 <-> 452, 471, 1868\n756 <-> 601\n757 <-> 1350, 1414\n758 <-> 488, 558, 652\n759 <-> 25, 1615\n760 <-> 184, 1274\n761 <-> 761\n762 <-> 322, 819\n763 <-> 14, 359, 511, 1542\n764 <-> 191\n765 <-> 1168\n766 <-> 269, 1167\n767 <-> 1109\n768 <-> 1784\n769 <-> 30, 769\n770 <-> 1328\n771 <-> 99, 244, 1310\n772 <-> 1378\n773 <-> 723, 882\n774 <-> 12\n775 <-> 185\n776 <-> 563\n777 <-> 817, 1559\n778 <-> 572, 1198\n779 <-> 1134\n780 <-> 623, 1645\n781 <-> 781\n782 <-> 990, 1387, 1755\n783 <-> 1015, 1391\n784 <-> 474, 538, 1531, 1804\n785 <-> 1802\n786 <-> 208, 1357\n787 <-> 787, 1233\n788 <-> 645\n789 <-> 536, 593, 1691\n790 <-> 870, 1901\n791 <-> 1888\n792 <-> 490, 1469, 1999\n793 <-> 15, 220, 1284, 1684, 1814\n794 <-> 1648\n795 <-> 708\n796 <-> 454, 1286\n797 <-> 797, 1014, 1028\n798 <-> 1079, 1531\n799 <-> 1159, 1351, 1526\n800 <-> 228, 1176, 1819\n801 <-> 1018\n802 <-> 1735\n803 <-> 68, 414, 1374, 1623\n804 <-> 640, 867, 1955\n805 <-> 805, 1843\n806 <-> 710\n807 <-> 80, 482, 538\n808 <-> 28\n809 <-> 240, 1246, 1582\n810 <-> 810, 1005\n811 <-> 811\n812 <-> 812, 1359\n813 <-> 408, 813\n814 <-> 356, 383\n815 <-> 203, 237, 848, 1720\n816 <-> 816\n817 <-> 777\n818 <-> 1169, 1828\n819 <-> 762\n820 <-> 820, 1557\n821 <-> 25, 510, 1288\n822 <-> 1073, 1883\n823 <-> 330, 925, 1323, 1883\n824 <-> 61, 353, 1820\n825 <-> 91, 1652\n826 <-> 671\n827 <-> 1183\n828 <-> 843\n829 <-> 615, 1661\n830 <-> 22\n831 <-> 507, 1054, 1439\n832 <-> 855\n833 <-> 171, 994, 1020\n834 <-> 1706\n835 <-> 42, 1951\n836 <-> 836\n837 <-> 1590\n838 <-> 1001\n839 <-> 175, 1329\n840 <-> 1274\n841 <-> 1933\n842 <-> 179, 545, 1771\n843 <-> 168, 828, 1032\n844 <-> 847, 1790\n845 <-> 529\n846 <-> 511\n847 <-> 844, 1077, 1172\n848 <-> 815, 1338, 1397, 1452\n849 <-> 1485, 1642\n850 <-> 551, 1630\n851 <-> 752, 1691, 1850\n852 <-> 693\n853 <-> 518, 1208, 1638, 1678\n854 <-> 149\n855 <-> 700, 832, 1450\n856 <-> 856\n857 <-> 741\n858 <-> 1891\n859 <-> 160, 1295, 1483\n860 <-> 373, 1214\n861 <-> 1134, 1564, 1961\n862 <-> 862, 1794\n863 <-> 942, 1671\n864 <-> 864\n865 <-> 1463, 1685\n866 <-> 1411\n867 <-> 804, 1492\n868 <-> 388, 611\n869 <-> 1417\n870 <-> 790, 872, 1910\n871 <-> 450, 568\n872 <-> 665, 870\n873 <-> 473\n874 <-> 0, 1000, 1147, 1534\n875 <-> 634, 1373, 1563\n876 <-> 526, 1517\n877 <-> 1911\n878 <-> 878\n879 <-> 8, 1887\n880 <-> 571, 927\n881 <-> 1945\n882 <-> 773\n883 <-> 909, 1141\n884 <-> 1865\n885 <-> 123, 1506\n886 <-> 213, 1511\n887 <-> 1413\n888 <-> 1640\n889 <-> 1629\n890 <-> 890, 964, 1894\n891 <-> 1242\n892 <-> 498, 547, 1082\n893 <-> 1035, 1555\n894 <-> 436, 1108\n895 <-> 1506, 1991\n896 <-> 572, 1339\n897 <-> 643, 1758\n898 <-> 967, 1481\n899 <-> 1094, 1791, 1976\n900 <-> 900, 1003\n901 <-> 469, 1420, 1751\n902 <-> 654, 1503\n903 <-> 498, 903, 1230\n904 <-> 1226\n905 <-> 313, 1208, 1749\n906 <-> 1276, 1541\n907 <-> 508, 1479\n908 <-> 463\n909 <-> 883, 909\n910 <-> 647\n911 <-> 41, 57, 1578\n912 <-> 264\n913 <-> 913, 1236\n914 <-> 332, 1800\n915 <-> 501, 660, 1386, 1429\n916 <-> 94, 104, 458, 1075, 1899\n917 <-> 186\n918 <-> 323\n919 <-> 374\n920 <-> 920\n921 <-> 1460\n922 <-> 164, 922\n923 <-> 1041\n924 <-> 48, 169, 683, 712, 1107, 1700\n925 <-> 823\n926 <-> 319, 1381\n927 <-> 880\n928 <-> 82, 473, 672, 1201\n929 <-> 424\n930 <-> 930, 1569\n931 <-> 398, 992\n932 <-> 280, 537, 598, 1292\n933 <-> 738, 1368\n934 <-> 426, 1161\n935 <-> 1086\n936 <-> 55, 427\n937 <-> 92, 231\n938 <-> 726, 1304\n939 <-> 958\n940 <-> 447, 1222\n941 <-> 87\n942 <-> 863\n943 <-> 741, 1421, 1832\n944 <-> 46, 111\n945 <-> 492, 656, 1353\n946 <-> 601\n947 <-> 1631\n948 <-> 948\n949 <-> 1434\n950 <-> 1594\n951 <-> 67, 1016, 1478\n952 <-> 1641\n953 <-> 609, 1176, 1513, 1714, 1958\n954 <-> 954\n955 <-> 955\n956 <-> 982, 1217\n957 <-> 91, 1106\n958 <-> 939, 1199, 1303, 1944\n959 <-> 1875\n960 <-> 644\n961 <-> 1619\n962 <-> 564, 662, 1884\n963 <-> 1015, 1851\n964 <-> 890\n965 <-> 1002\n966 <-> 1793\n967 <-> 641, 898\n968 <-> 968\n969 <-> 233, 273, 1212, 1978\n970 <-> 1499, 1513\n971 <-> 1106\n972 <-> 1738\n973 <-> 973\n974 <-> 1646, 1967\n975 <-> 1066\n976 <-> 1287, 1640\n977 <-> 1954\n978 <-> 489, 1697\n979 <-> 331\n980 <-> 529\n981 <-> 396, 643, 1376, 1925\n982 <-> 956\n983 <-> 1325, 1831\n984 <-> 161, 592, 1579\n985 <-> 239\n986 <-> 1104, 1830\n987 <-> 1419\n988 <-> 90, 1718, 1737\n989 <-> 1278, 1635\n990 <-> 375, 616, 782, 1973\n991 <-> 1852\n992 <-> 931, 1722, 1724\n993 <-> 1099\n994 <-> 668, 833\n995 <-> 1140, 1803\n996 <-> 996, 1673\n997 <-> 997\n998 <-> 565, 998\n999 <-> 563, 999\n1000 <-> 874, 1160\n1001 <-> 193, 838, 1011, 1710\n1002 <-> 965, 1571\n1003 <-> 900\n1004 <-> 1004\n1005 <-> 810, 1775\n1006 <-> 1006\n1007 <-> 306, 1447\n1008 <-> 61\n1009 <-> 1022, 1320\n1010 <-> 191, 603, 726, 1344\n1011 <-> 401, 1001\n1012 <-> 1112, 1194\n1013 <-> 691, 1031\n1014 <-> 797\n1015 <-> 783, 963\n1016 <-> 951, 1989\n1017 <-> 1213, 1818, 1824\n1018 <-> 801, 1062\n1019 <-> 1327\n1020 <-> 534, 833\n1021 <-> 22, 647, 1210\n1022 <-> 735, 1009, 1413\n1023 <-> 434, 677\n1024 <-> 1071\n1025 <-> 289, 1416, 1704\n1026 <-> 373\n1027 <-> 428, 629\n1028 <-> 492, 797, 1113\n1029 <-> 1038, 1268\n1030 <-> 225, 1430\n1031 <-> 1013\n1032 <-> 843\n1033 <-> 513\n1034 <-> 1179\n1035 <-> 139, 893, 1151\n1036 <-> 346, 1598\n1037 <-> 141, 1649\n1038 <-> 60, 1029\n1039 <-> 716, 1039\n1040 <-> 1040, 1042\n1041 <-> 202, 923, 1041\n1042 <-> 1040, 1918\n1043 <-> 597\n1044 <-> 202\n1045 <-> 1045\n1046 <-> 253, 1394, 1770\n1047 <-> 32, 240, 1748\n1048 <-> 135, 1348\n1049 <-> 1071\n1050 <-> 99, 601, 1953\n1051 <-> 244, 1345\n1052 <-> 347, 1686\n1053 <-> 317\n1054 <-> 831, 1872\n1055 <-> 1062, 1123, 1574, 1680\n1056 <-> 112\n1057 <-> 168\n1058 <-> 7, 722\n1059 <-> 1059\n1060 <-> 603, 1277, 1669\n1061 <-> 719\n1062 <-> 1018, 1055\n1063 <-> 377\n1064 <-> 323, 599, 645, 1229, 1796\n1065 <-> 599, 740, 1394\n1066 <-> 975, 1867\n1067 <-> 404, 1252, 1922\n1068 <-> 230, 514, 541\n1069 <-> 198, 1102\n1070 <-> 1147\n1071 <-> 1024, 1049, 1088, 1188\n1072 <-> 218, 1434, 1447\n1073 <-> 822, 1546\n1074 <-> 7\n1075 <-> 451, 916, 1610\n1076 <-> 340\n1077 <-> 847\n1078 <-> 623, 1960\n1079 <-> 798\n1080 <-> 687\n1081 <-> 662, 1238\n1082 <-> 65, 108, 892\n1083 <-> 1396\n1084 <-> 225\n1085 <-> 128, 1513, 1528\n1086 <-> 47, 527, 935\n1087 <-> 1616, 1823, 1826\n1088 <-> 1071\n1089 <-> 412\n1090 <-> 150, 1652, 1865\n1091 <-> 1091\n1092 <-> 1742\n1093 <-> 1408\n1094 <-> 450, 899, 1719, 1783\n1095 <-> 18\n1096 <-> 1145\n1097 <-> 1571, 1971\n1098 <-> 162, 483, 1268\n1099 <-> 1, 993, 1099, 1584\n1100 <-> 741, 1100\n1101 <-> 368, 705\n1102 <-> 537, 1069\n1103 <-> 119, 1586, 1939\n1104 <-> 171, 986\n1105 <-> 1211, 1443, 1913\n1106 <-> 957, 971, 1568\n1107 <-> 924, 1336, 1487, 1831\n1108 <-> 894\n1109 <-> 767, 1159, 1525\n1110 <-> 1612, 1976\n1111 <-> 1980\n1112 <-> 1012, 1588\n1113 <-> 1028\n1114 <-> 642, 1197\n1115 <-> 23, 215, 501\n1116 <-> 1992\n1117 <-> 1117\n1118 <-> 247, 434, 438\n1119 <-> 187, 1215, 1843\n1120 <-> 1267, 1270\n1121 <-> 1591, 1820\n1122 <-> 1531, 1747\n1123 <-> 1055\n1124 <-> 1654\n1125 <-> 1497\n1126 <-> 123, 1425, 1729\n1127 <-> 216, 242, 509\n1128 <-> 1580\n1129 <-> 251, 1302\n1130 <-> 564\n1131 <-> 1335, 1595\n1132 <-> 30\n1133 <-> 5, 1655\n1134 <-> 779, 861\n1135 <-> 1135\n1136 <-> 7\n1137 <-> 27\n1138 <-> 199\n1139 <-> 271, 1474\n1140 <-> 995, 1430, 1474\n1141 <-> 883\n1142 <-> 70, 1886\n1143 <-> 52, 1143\n1144 <-> 1554\n1145 <-> 1096, 1145\n1146 <-> 1776, 1917\n1147 <-> 874, 1070, 1240\n1148 <-> 1444, 1451, 1961\n1149 <-> 171\n1150 <-> 578, 635, 1583\n1151 <-> 1035, 1348\n1152 <-> 1661\n1153 <-> 1552\n1154 <-> 1154, 1947\n1155 <-> 1155, 1618\n1156 <-> 271, 1677\n1157 <-> 1491, 1592, 1884\n1158 <-> 72, 1220\n1159 <-> 799, 1109\n1160 <-> 1000\n1161 <-> 934, 1951\n1162 <-> 178, 1242, 1905\n1163 <-> 1474\n1164 <-> 261\n1165 <-> 106, 1165, 1676\n1166 <-> 1166\n1167 <-> 766, 1450, 1912, 1927\n1168 <-> 246, 765\n1169 <-> 46, 818\n1170 <-> 1689\n1171 <-> 395\n1172 <-> 847, 1250, 1689\n1173 <-> 1173\n1174 <-> 1893\n1175 <-> 1294\n1176 <-> 800, 953\n1177 <-> 543, 1315\n1178 <-> 322, 464, 691\n1179 <-> 1034, 1238\n1180 <-> 319\n1181 <-> 1996\n1182 <-> 178, 1881\n1183 <-> 827, 1552\n1184 <-> 686, 730\n1185 <-> 110, 1281\n1186 <-> 539, 1217, 1809\n1187 <-> 1242, 1257\n1188 <-> 302, 1071, 1949, 1980\n1189 <-> 1319\n1190 <-> 1947\n1191 <-> 1191\n1192 <-> 590\n1193 <-> 1204, 1260\n1194 <-> 1012\n1195 <-> 497\n1196 <-> 1196, 1516\n1197 <-> 1114\n1198 <-> 702, 778\n1199 <-> 282, 958\n1200 <-> 1664\n1201 <-> 928\n1202 <-> 1202, 1355\n1203 <-> 1203, 1966\n1204 <-> 469, 1193\n1205 <-> 52, 688\n1206 <-> 387\n1207 <-> 1993\n1208 <-> 673, 853, 905\n1209 <-> 136, 1462\n1210 <-> 1021\n1211 <-> 1105, 1211\n1212 <-> 56, 574, 969, 1705\n1213 <-> 612, 1017, 1663\n1214 <-> 723, 860\n1215 <-> 1119, 1615\n1216 <-> 1524, 1798\n1217 <-> 646, 956, 1186\n1218 <-> 235, 1580\n1219 <-> 113, 579, 1841\n1220 <-> 255, 1158, 1681\n1221 <-> 1331, 1360\n1222 <-> 940\n1223 <-> 29, 1237\n1224 <-> 540, 1523\n1225 <-> 597, 749, 1225\n1226 <-> 904, 1226\n1227 <-> 1934\n1228 <-> 1228\n1229 <-> 87, 1064\n1230 <-> 903\n1231 <-> 293, 658, 1402\n1232 <-> 680, 1417\n1233 <-> 787\n1234 <-> 683\n1235 <-> 708\n1236 <-> 278, 913\n1237 <-> 295, 576, 1223\n1238 <-> 1081, 1179, 1326, 1806\n1239 <-> 338\n1240 <-> 702, 1147\n1241 <-> 1921\n1242 <-> 891, 1162, 1187, 1965\n1243 <-> 134, 461, 528\n1244 <-> 579\n1245 <-> 400, 1245, 1864\n1246 <-> 809, 1772\n1247 <-> 656, 684\n1248 <-> 287, 631\n1249 <-> 91, 111, 1782\n1250 <-> 1172\n1251 <-> 572, 1508\n1252 <-> 277, 1067, 1505\n1253 <-> 21, 1639\n1254 <-> 26, 149, 250\n1255 <-> 190, 495\n1256 <-> 1256, 1286\n1257 <-> 101, 471, 1187\n1258 <-> 3, 233, 446, 1309\n1259 <-> 1398\n1260 <-> 1193, 1517\n1261 <-> 1300, 1807\n1262 <-> 1508\n1263 <-> 1973\n1264 <-> 176, 728, 1307\n1265 <-> 1265\n1266 <-> 1507, 1720\n1267 <-> 1120\n1268 <-> 364, 1029, 1098\n1269 <-> 1875\n1270 <-> 1120, 1915\n1271 <-> 448\n1272 <-> 6\n1273 <-> 1273\n1274 <-> 442, 760, 840\n1275 <-> 197, 670, 1450\n1276 <-> 906\n1277 <-> 1060\n1278 <-> 989, 1878, 1986\n1279 <-> 1279, 1848\n1280 <-> 435, 1915\n1281 <-> 1185\n1282 <-> 524\n1283 <-> 1678\n1284 <-> 793, 1706\n1285 <-> 1642\n1286 <-> 796, 1256, 1630\n1287 <-> 976, 1287\n1288 <-> 821\n1289 <-> 415\n1290 <-> 127, 256\n1291 <-> 209\n1292 <-> 932\n1293 <-> 754, 1293\n1294 <-> 180, 1175, 1882\n1295 <-> 859\n1296 <-> 360, 1910\n1297 <-> 258, 1426\n1298 <-> 205\n1299 <-> 661, 1954\n1300 <-> 300, 368, 1261\n1301 <-> 1834, 1847\n1302 <-> 708, 1129\n1303 <-> 958\n1304 <-> 938\n1305 <-> 1305\n1306 <-> 677\n1307 <-> 1264\n1308 <-> 282, 481\n1309 <-> 1258\n1310 <-> 771, 1392\n1311 <-> 203, 281, 424\n1312 <-> 433, 1312, 1671\n1313 <-> 568, 1409, 1861\n1314 <-> 221, 476, 1549\n1315 <-> 1177\n1316 <-> 596\n1317 <-> 1832\n1318 <-> 1468\n1319 <-> 144, 1189, 1319, 1542, 1923\n1320 <-> 210, 541, 575, 1009\n1321 <-> 456\n1322 <-> 654\n1323 <-> 823, 1385\n1324 <-> 692\n1325 <-> 85, 88, 983\n1326 <-> 1238\n1327 <-> 1019, 1387\n1328 <-> 153, 770\n1329 <-> 625, 839\n1330 <-> 672\n1331 <-> 392, 1221\n1332 <-> 245, 542\n1333 <-> 1333\n1334 <-> 405, 1987\n1335 <-> 1131, 1744\n1336 <-> 1107\n1337 <-> 314, 1379\n1338 <-> 848\n1339 <-> 896, 1523\n1340 <-> 211, 1460\n1341 <-> 352, 1459, 1849, 1878\n1342 <-> 629, 645, 1752\n1343 <-> 129\n1344 <-> 1010\n1345 <-> 139, 1051\n1346 <-> 1845\n1347 <-> 76, 506\n1348 <-> 1048, 1151\n1349 <-> 302\n1350 <-> 138, 306, 757\n1351 <-> 156, 209, 799, 1916\n1352 <-> 371, 1352\n1353 <-> 945, 1811\n1354 <-> 1871\n1355 <-> 1202, 1533\n1356 <-> 1548, 1566, 1840\n1357 <-> 312, 786\n1358 <-> 567, 710\n1359 <-> 812\n1360 <-> 327, 1221, 1659\n1361 <-> 704, 1901\n1362 <-> 143, 266, 1551\n1363 <-> 516, 688\n1364 <-> 333\n1365 <-> 421\n1366 <-> 692, 726, 1972\n1367 <-> 1367, 1946\n1368 <-> 682, 933, 1465, 1478\n1369 <-> 1369\n1370 <-> 189\n1371 <-> 215, 1572, 1870\n1372 <-> 1372\n1373 <-> 875\n1374 <-> 803\n1375 <-> 284\n1376 <-> 981, 1545\n1377 <-> 31, 285\n1378 <-> 772, 1378\n1379 <-> 241, 1337, 1587\n1380 <-> 20, 1856\n1381 <-> 228, 926\n1382 <-> 680\n1383 <-> 525\n1384 <-> 1792\n1385 <-> 1323, 1521\n1386 <-> 915\n1387 <-> 782, 1327\n1388 <-> 395, 1416, 1525\n1389 <-> 376, 556\n1390 <-> 1390, 1406\n1391 <-> 783, 1550, 1595\n1392 <-> 365, 1310, 1793\n1393 <-> 1505, 1667\n1394 <-> 12, 586, 1046, 1065\n1395 <-> 680\n1396 <-> 729, 1083\n1397 <-> 848, 1944\n1398 <-> 449, 753, 1259\n1399 <-> 526\n1400 <-> 742\n1401 <-> 1401\n1402 <-> 1231\n1403 <-> 1967\n1404 <-> 544\n1405 <-> 677\n1406 <-> 1390\n1407 <-> 291, 1407\n1408 <-> 1093, 1947\n1409 <-> 1313\n1410 <-> 236, 635, 663\n1411 <-> 151, 866\n1412 <-> 1663\n1413 <-> 887, 1022\n1414 <-> 757, 1666\n1415 <-> 130, 310\n1416 <-> 1025, 1388\n1417 <-> 744, 869, 1232, 1641\n1418 <-> 689\n1419 <-> 669, 987, 1419, 1431\n1420 <-> 901\n1421 <-> 943\n1422 <-> 1422\n1423 <-> 173, 570\n1424 <-> 1424\n1425 <-> 1126\n1426 <-> 66, 1297\n1427 <-> 1466\n1428 <-> 1523, 1626\n1429 <-> 172, 915\n1430 <-> 1030, 1140\n1431 <-> 504, 1419\n1432 <-> 457\n1433 <-> 168, 746\n1434 <-> 949, 1072, 1474\n1435 <-> 1688\n1436 <-> 24, 1624\n1437 <-> 1903\n1438 <-> 1438, 1447\n1439 <-> 831\n1440 <-> 1788\n1441 <-> 1441\n1442 <-> 180\n1443 <-> 1105\n1444 <-> 1148\n1445 <-> 94, 1693\n1446 <-> 15, 620\n1447 <-> 1007, 1072, 1438\n1448 <-> 1617\n1449 <-> 500\n1450 <-> 855, 1167, 1275\n1451 <-> 1148, 1556\n1452 <-> 165, 848\n1453 <-> 90, 1726\n1454 <-> 320, 1869\n1455 <-> 37\n1456 <-> 58\n1457 <-> 288\n1458 <-> 1637\n1459 <-> 1341\n1460 <-> 921, 1340\n1461 <-> 739, 1621\n1462 <-> 248, 1209\n1463 <-> 865\n1464 <-> 1747\n1465 <-> 1368\n1466 <-> 585, 1427, 1655\n1467 <-> 1467\n1468 <-> 1318, 1468\n1469 <-> 792\n1470 <-> 236, 423\n1471 <-> 145\n1472 <-> 1485, 1857\n1473 <-> 4, 254\n1474 <-> 1139, 1140, 1163, 1434\n1475 <-> 396, 1923\n1476 <-> 467, 718\n1477 <-> 16, 1478\n1478 <-> 951, 1368, 1477\n1479 <-> 305, 907, 1675\n1480 <-> 207, 448, 496\n1481 <-> 898, 1890\n1482 <-> 1595\n1483 <-> 859, 1502\n1484 <-> 1545\n1485 <-> 308, 849, 1472\n1486 <-> 290\n1487 <-> 1107\n1488 <-> 76\n1489 <-> 375\n1490 <-> 1490\n1491 <-> 1157, 1510\n1492 <-> 867, 1492\n1493 <-> 297, 1724\n1494 <-> 689, 1494\n1495 <-> 12\n1496 <-> 1636\n1497 <-> 66, 1125\n1498 <-> 429\n1499 <-> 970\n1500 <-> 1664\n1501 <-> 1954\n1502 <-> 306, 1483\n1503 <-> 351, 902\n1504 <-> 373, 1980\n1505 <-> 1252, 1393\n1506 <-> 885, 895\n1507 <-> 118, 262, 714, 1266\n1508 <-> 618, 1251, 1262, 1611\n1509 <-> 315\n1510 <-> 379, 1491\n1511 <-> 578, 886\n1512 <-> 40\n1513 <-> 634, 953, 970, 1085\n1514 <-> 67\n1515 <-> 653\n1516 <-> 92, 1196, 1647\n1517 <-> 876, 1260\n1518 <-> 238, 453\n1519 <-> 416, 1936\n1520 <-> 1609\n1521 <-> 585, 1385\n1522 <-> 44, 499, 532\n1523 <-> 1224, 1339, 1428, 1589\n1524 <-> 731, 1216, 1524\n1525 <-> 582, 1109, 1388\n1526 <-> 594, 799\n1527 <-> 1900, 1906\n1528 <-> 1085\n1529 <-> 1529, 1622\n1530 <-> 134, 1994\n1531 <-> 784, 798, 1122\n1532 <-> 699, 1532\n1533 <-> 1355, 1997\n1534 <-> 874, 1992\n1535 <-> 1777\n1536 <-> 1798\n1537 <-> 84\n1538 <-> 1740\n1539 <-> 1539\n1540 <-> 341\n1541 <-> 186, 351, 906\n1542 <-> 763, 1319\n1543 <-> 437, 1675\n1544 <-> 340, 1544\n1545 <-> 1376, 1484\n1546 <-> 1073, 1987\n1547 <-> 344, 1769\n1548 <-> 1356, 1990\n1549 <-> 214, 1314\n1550 <-> 1391\n1551 <-> 1362, 1929\n1552 <-> 406, 632, 1153, 1183\n1553 <-> 1916\n1554 <-> 1144, 1721, 1984\n1555 <-> 893\n1556 <-> 1451, 1963\n1557 <-> 820\n1558 <-> 1558, 1623\n1559 <-> 777, 1674\n1560 <-> 1560\n1561 <-> 523, 1564\n1562 <-> 205, 1773, 1948, 1985\n1563 <-> 34, 875\n1564 <-> 861, 1561\n1565 <-> 1941\n1566 <-> 1356, 1779\n1567 <-> 544, 1567\n1568 <-> 1106\n1569 <-> 712, 930\n1570 <-> 601\n1571 <-> 1002, 1097\n1572 <-> 1371\n1573 <-> 1573\n1574 <-> 1055, 1942\n1575 <-> 132\n1576 <-> 328\n1577 <-> 241\n1578 <-> 911\n1579 <-> 984\n1580 <-> 427, 1128, 1218\n1581 <-> 486\n1582 <-> 491, 809, 1751, 1842\n1583 <-> 1150\n1584 <-> 1099, 1839\n1585 <-> 1817\n1586 <-> 1103\n1587 <-> 1379\n1588 <-> 744, 1112\n1589 <-> 1523\n1590 <-> 837, 1590\n1591 <-> 29, 1121, 1603\n1592 <-> 1157, 1592\n1593 <-> 575\n1594 <-> 950, 1767\n1595 <-> 339, 1131, 1391, 1482\n1596 <-> 1596\n1597 <-> 1745\n1598 <-> 1036\n1599 <-> 226, 510\n1600 <-> 38\n1601 <-> 485, 1695, 1801\n1602 <-> 205\n1603 <-> 1591\n1604 <-> 1604\n1605 <-> 5, 201, 479\n1606 <-> 313\n1607 <-> 432\n1608 <-> 145, 1906\n1609 <-> 276, 504, 1520\n1610 <-> 1075\n1611 <-> 1508, 1641\n1612 <-> 1110\n1613 <-> 285\n1614 <-> 152\n1615 <-> 351, 759, 1215\n1616 <-> 1087\n1617 <-> 396, 1448\n1618 <-> 1155, 1971\n1619 <-> 672, 961\n1620 <-> 179, 1739\n1621 <-> 1461\n1622 <-> 1529, 1893\n1623 <-> 803, 1558\n1624 <-> 500, 1436\n1625 <-> 682\n1626 <-> 131, 1428\n1627 <-> 314\n1628 <-> 95, 684\n1629 <-> 889, 1629\n1630 <-> 850, 1286\n1631 <-> 947, 1631, 1952\n1632 <-> 386, 1646\n1633 <-> 181\n1634 <-> 6, 1634\n1635 <-> 374, 989\n1636 <-> 687, 1496, 1839\n1637 <-> 54, 259, 739, 1458\n1638 <-> 157, 853\n1639 <-> 1253\n1640 <-> 888, 976, 1679\n1641 <-> 952, 1417, 1611, 1810\n1642 <-> 849, 1285, 1995\n1643 <-> 1774, 1993, 1996\n1644 <-> 516\n1645 <-> 780\n1646 <-> 107, 974, 1632\n1647 <-> 1516\n1648 <-> 77, 153, 794\n1649 <-> 1037\n1650 <-> 1843\n1651 <-> 236\n1652 <-> 825, 1090\n1653 <-> 564\n1654 <-> 1124, 1977\n1655 <-> 1133, 1466\n1656 <-> 154, 357, 557\n1657 <-> 669\n1658 <-> 1670\n1659 <-> 1360, 1840\n1660 <-> 69\n1661 <-> 286, 494, 829, 1152\n1662 <-> 1662, 1663\n1663 <-> 1213, 1412, 1662\n1664 <-> 49, 371, 1200, 1500, 1937\n1665 <-> 733\n1666 <-> 1414\n1667 <-> 329, 365, 1393\n1668 <-> 578, 1934\n1669 <-> 1060, 1935\n1670 <-> 726, 1658\n1671 <-> 863, 1312, 1919\n1672 <-> 255\n1673 <-> 996\n1674 <-> 190, 1559, 1815\n1675 <-> 1479, 1543\n1676 <-> 1165\n1677 <-> 1156\n1678 <-> 853, 1283, 1889\n1679 <-> 1640\n1680 <-> 1055\n1681 <-> 34, 1220\n1682 <-> 1690, 1757\n1683 <-> 1879\n1684 <-> 351, 793\n1685 <-> 504, 865\n1686 <-> 548, 1052, 1686\n1687 <-> 275\n1688 <-> 151, 164, 1435\n1689 <-> 63, 1170, 1172\n1690 <-> 38, 1682\n1691 <-> 391, 411, 789, 851\n1692 <-> 241\n1693 <-> 1445\n1694 <-> 1717\n1695 <-> 1601\n1696 <-> 14\n1697 <-> 978, 1992\n1698 <-> 1997\n1699 <-> 260\n1700 <-> 924\n1701 <-> 215, 303\n1702 <-> 1742\n1703 <-> 519, 1905\n1704 <-> 1025\n1705 <-> 105, 1212\n1706 <-> 727, 834, 1284\n1707 <-> 1707\n1708 <-> 257\n1709 <-> 218\n1710 <-> 1001\n1711 <-> 60, 204\n1712 <-> 1712\n1713 <-> 133, 207, 388\n1714 <-> 746, 953\n1715 <-> 562\n1716 <-> 1716\n1717 <-> 192, 1694\n1718 <-> 988\n1719 <-> 1094\n1720 <-> 815, 1266\n1721 <-> 1554\n1722 <-> 992\n1723 <-> 1723\n1724 <-> 992, 1493, 1745\n1725 <-> 677, 1731\n1726 <-> 29, 1453\n1727 <-> 420, 1858\n1728 <-> 631\n1729 <-> 1126\n1730 <-> 297, 1825\n1731 <-> 1725\n1732 <-> 1732, 1799\n1733 <-> 295\n1734 <-> 131\n1735 <-> 549, 802\n1736 <-> 10, 1757\n1737 <-> 988, 1768\n1738 <-> 972, 1844\n1739 <-> 641, 642, 1620, 1739\n1740 <-> 1538, 1961\n1741 <-> 1935\n1742 <-> 1092, 1702, 1903\n1743 <-> 1845, 1945\n1744 <-> 1335, 1744\n1745 <-> 1597, 1724, 1745\n1746 <-> 1975\n1747 <-> 209, 1122, 1464\n1748 <-> 1047\n1749 <-> 905\n1750 <-> 377, 1996\n1751 <-> 901, 1582\n1752 <-> 1342\n1753 <-> 1974, 1998\n1754 <-> 15, 102\n1755 <-> 782, 1821\n1756 <-> 1756\n1757 <-> 241, 1682, 1736, 1959\n1758 <-> 897\n1759 <-> 1871\n1760 <-> 576\n1761 <-> 733, 1761\n1762 <-> 615, 1882\n1763 <-> 1825\n1764 <-> 320\n1765 <-> 349, 721\n1766 <-> 1781\n1767 <-> 1594, 1767\n1768 <-> 1737\n1769 <-> 161, 385, 1547\n1770 <-> 1046\n1771 <-> 842, 1930\n1772 <-> 1246\n1773 <-> 1562\n1774 <-> 1643\n1775 <-> 1005\n1776 <-> 475, 483, 1146, 1822, 1928\n1777 <-> 1535, 1777\n1778 <-> 529, 1857\n1779 <-> 512, 1566\n1780 <-> 1780\n1781 <-> 55, 389, 1766\n1782 <-> 1249\n1783 <-> 181, 1094, 1933\n1784 <-> 616, 768\n1785 <-> 369, 546\n1786 <-> 493\n1787 <-> 307, 1787\n1788 <-> 1440, 1972\n1789 <-> 318\n1790 <-> 844, 1790\n1791 <-> 487, 899\n1792 <-> 189, 382, 1384\n1793 <-> 966, 1392\n1794 <-> 45, 862\n1795 <-> 1944\n1796 <-> 1064\n1797 <-> 33\n1798 <-> 1216, 1536\n1799 <-> 284, 1732, 1924\n1800 <-> 221, 914\n1801 <-> 1601\n1802 <-> 117, 583, 785\n1803 <-> 995\n1804 <-> 355, 784\n1805 <-> 129\n1806 <-> 1238, 1853\n1807 <-> 1261\n1808 <-> 461\n1809 <-> 180, 316, 602, 1186\n1810 <-> 1641\n1811 <-> 1353\n1812 <-> 159, 458, 559, 1833\n1813 <-> 1880\n1814 <-> 336, 793\n1815 <-> 399, 1674\n1816 <-> 1816\n1817 <-> 20, 1585\n1818 <-> 1017\n1819 <-> 800\n1820 <-> 824, 1121, 1898\n1821 <-> 1755\n1822 <-> 1776\n1823 <-> 1087\n1824 <-> 234, 1017\n1825 <-> 478, 1730, 1763\n1826 <-> 11, 384, 608, 1087, 1884\n1827 <-> 326, 629\n1828 <-> 33, 818\n1829 <-> 630\n1830 <-> 986\n1831 <-> 522, 983, 1107\n1832 <-> 943, 1317, 1860\n1833 <-> 369, 1812\n1834 <-> 1301\n1835 <-> 375\n1836 <-> 394, 652\n1837 <-> 36, 484\n1838 <-> 256, 1912\n1839 <-> 1584, 1636\n1840 <-> 93, 1356, 1659\n1841 <-> 1219\n1842 <-> 1582, 1892\n1843 <-> 805, 1119, 1650\n1844 <-> 208, 594, 1738\n1845 <-> 681, 1346, 1743\n1846 <-> 1846\n1847 <-> 1301, 1847\n1848 <-> 1279\n1849 <-> 1341\n1850 <-> 851, 1850\n1851 <-> 520, 963\n1852 <-> 524, 663, 991, 1936\n1853 <-> 568, 1806\n1854 <-> 405\n1855 <-> 736\n1856 <-> 587, 1380\n1857 <-> 1472, 1778, 1893\n1858 <-> 414, 1727, 1896, 1983\n1859 <-> 1859\n1860 <-> 280, 1832, 1895\n1861 <-> 1313\n1862 <-> 245\n1863 <-> 674, 1863\n1864 <-> 1245\n1865 <-> 884, 1090\n1866 <-> 418, 461\n1867 <-> 686, 1066\n1868 <-> 354, 755, 1909\n1869 <-> 238, 1454\n1870 <-> 713, 1371\n1871 <-> 667, 1354, 1759\n1872 <-> 253, 614, 1054\n1873 <-> 268\n1874 <-> 75, 1927\n1875 <-> 680, 959, 1269\n1876 <-> 628\n1877 <-> 20, 638\n1878 <-> 344, 1278, 1341, 1890\n1879 <-> 1683, 1879\n1880 <-> 199, 592, 1813\n1881 <-> 1182\n1882 <-> 196, 1294, 1762\n1883 <-> 822, 823\n1884 <-> 962, 1157, 1826\n1885 <-> 51, 1923\n1886 <-> 1142\n1887 <-> 294, 879\n1888 <-> 514, 791\n1889 <-> 1678\n1890 <-> 1481, 1878\n1891 <-> 17, 858\n1892 <-> 362, 1842\n1893 <-> 485, 648, 1174, 1622, 1857\n1894 <-> 890\n1895 <-> 1860\n1896 <-> 1858\n1897 <-> 1897\n1898 <-> 1820\n1899 <-> 916\n1900 <-> 1527\n1901 <-> 324, 790, 1361, 1901\n1902 <-> 594\n1903 <-> 650, 1437, 1742, 1903, 1968\n1904 <-> 317\n1905 <-> 679, 1162, 1703\n1906 <-> 1527, 1608, 1932\n1907 <-> 1907\n1908 <-> 1908\n1909 <-> 1868\n1910 <-> 870, 1296\n1911 <-> 223, 239, 402, 877\n1912 <-> 1167, 1838\n1913 <-> 1105\n1914 <-> 123, 166\n1915 <-> 1270, 1280\n1916 <-> 1351, 1553\n1917 <-> 1146\n1918 <-> 1042\n1919 <-> 1671\n1920 <-> 460\n1921 <-> 33, 1241\n1922 <-> 1067\n1923 <-> 1319, 1475, 1885\n1924 <-> 1799\n1925 <-> 290, 981\n1926 <-> 62, 460\n1927 <-> 1167, 1874\n1928 <-> 550, 1776\n1929 <-> 1551\n1930 <-> 1771\n1931 <-> 122, 386\n1932 <-> 1906\n1933 <-> 841, 1783\n1934 <-> 1227, 1668\n1935 <-> 1669, 1741\n1936 <-> 1519, 1852\n1937 <-> 71, 1664\n1938 <-> 283, 456\n1939 <-> 1103\n1940 <-> 0\n1941 <-> 222, 499, 1565, 1941\n1942 <-> 61, 311, 1574\n1943 <-> 161\n1944 <-> 193, 958, 1397, 1795\n1945 <-> 257, 881, 1743\n1946 <-> 1367\n1947 <-> 1154, 1190, 1408\n1948 <-> 1562, 1948\n1949 <-> 1188\n1950 <-> 348\n1951 <-> 178, 835, 1161\n1952 <-> 1631\n1953 <-> 1050\n1954 <-> 977, 1299, 1501\n1955 <-> 804\n1956 <-> 1956\n1957 <-> 323, 657\n1958 <-> 298, 953\n1959 <-> 1757\n1960 <-> 27, 1078\n1961 <-> 387, 861, 1148, 1740\n1962 <-> 732, 1962\n1963 <-> 1556\n1964 <-> 1964\n1965 <-> 1242\n1966 <-> 1203\n1967 <-> 974, 1403\n1968 <-> 1903\n1969 <-> 664\n1970 <-> 17, 509, 1970\n1971 <-> 1097, 1618\n1972 <-> 155, 1366, 1788\n1973 <-> 547, 990, 1263\n1974 <-> 184, 1753\n1975 <-> 229, 1746\n1976 <-> 899, 1110\n1977 <-> 165, 1654\n1978 <-> 969\n1979 <-> 696, 717\n1980 <-> 1111, 1188, 1504\n1981 <-> 595\n1982 <-> 1982\n1983 <-> 380, 1858\n1984 <-> 278, 1554\n1985 <-> 1562\n1986 <-> 1278\n1987 <-> 1334, 1546\n1988 <-> 404\n1989 <-> 588, 1016\n1990 <-> 682, 712, 1548\n1991 <-> 41, 895\n1992 <-> 1116, 1534, 1697\n1993 <-> 15, 1207, 1643\n1994 <-> 1530\n1995 <-> 1642\n1996 <-> 167, 1181, 1643, 1750\n1997 <-> 1533, 1698\n1998 <-> 95, 141, 1753\n1999 <-> 792")

(defn parse-line [s]
  (let [[a others] (str/split s #" <-> ")
        others (str/split others #", ")]
    [(u/to-int a) (mapv u/to-int others)]))

(defn parse [s]
  (->> s (str/split-lines) (map parse-line)))

(def sconj (fnil conj #{}))

(defn collect-one [db [from tos]]
  (reduce
    (fn rf [db to]
      (-> db
        (update to sconj from)
        (update from sconj to)))
    db
    tos))

(defn collect [pairs]
  (reduce collect-one {} pairs))


(defn pull [db root]
  (loop [todo [root]
         done #{}]
    (if (empty? todo)
      done
      (let [friends (set (mapcat db todo))
            todo*   (set/difference friends done)
            done*   (into done todo)]
        (recur todo* done*)))))

(defn init-db [input]
  (-> input parse collect))


(defn remove-group [db]
  (when (seq db)
    (let [root  (ffirst db)
          group (pull db root)]
      (reduce dissoc db group))))

(defn f1 [input] (-> input init-db (pull 0) count))
(defn f2 [input] (->> input init-db (iterate remove-group) (take-while some?) count dec));;remove initial val

(assert (= 239 (f1 input)))
(assert (= 215 (f2 input)))